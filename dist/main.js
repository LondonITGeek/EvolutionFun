!function(c){var n={};function t(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return c[e].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=c,t.c=n,t.d=function(c,n,e){t.o(c,n)||Object.defineProperty(c,n,{enumerable:!0,get:e})},t.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},t.t=function(c,n){if(1&n&&(c=t(c)),8&n)return c;if(4&n&&"object"==typeof c&&c&&c.__esModule)return c;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:c}),2&n&&"string"!=typeof c)for(var r in c)t.d(e,r,function(n){return c[n]}.bind(null,r));return e},t.n=function(c){var n=c&&c.__esModule?function(){return c.default}:function(){return c};return t.d(n,"a",n),n},t.o=function(c,n){return Object.prototype.hasOwnProperty.call(c,n)},t.p="",t(t.s=0)}([function(module,exports,__webpack_require__){eval("const { default: Simulation } = __webpack_require__(3);\r\nconst { default: SuccessCriteria } = __webpack_require__(1);\r\nconst { SuccessCriteriaVisualization } = __webpack_require__(2);\r\n\r\nvar successCriteriaVisualization = new SuccessCriteriaVisualization(SuccessCriteria.centerSuccess());\r\nvar simulation = new Simulation(5000, 200, 300, 0, 10, 8, 0.0001, successCriteriaVisualization);\r\nsimulation.start();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/YjYzNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLHNCQUFzQixHQUFHLG1CQUFPLENBQUMsQ0FBYztBQUN0RCxPQUFPLDJCQUEyQixHQUFHLG1CQUFPLENBQUMsQ0FBb0I7QUFDakUsT0FBTywrQkFBK0IsR0FBRyxtQkFBTyxDQUFDLENBQWtDOztBQUVuRjtBQUNBO0FBQ0EiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZGVmYXVsdDogU2ltdWxhdGlvbiB9ID0gcmVxdWlyZShcIi4vc2ltdWxhdGlvblwiKTtcclxuY29uc3QgeyBkZWZhdWx0OiBTdWNjZXNzQ3JpdGVyaWEgfSA9IHJlcXVpcmUoXCIuL3N1Y2Nlc3MtY3JpdGVyaWFcIik7XHJcbmNvbnN0IHsgU3VjY2Vzc0NyaXRlcmlhVmlzdWFsaXphdGlvbiB9ID0gcmVxdWlyZShcIi4vc3VjY2Vzcy1jcml0ZXJpYS12aXN1YWxpemF0aW9uXCIpO1xyXG5cclxudmFyIHN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb24gPSBuZXcgU3VjY2Vzc0NyaXRlcmlhVmlzdWFsaXphdGlvbihTdWNjZXNzQ3JpdGVyaWEuY2VudGVyU3VjY2VzcygpKTtcclxudmFyIHNpbXVsYXRpb24gPSBuZXcgU2ltdWxhdGlvbig1MDAwLCAyMDAsIDMwMCwgMCwgMTAsIDgsIDAuMDAwMSwgc3VjY2Vzc0NyaXRlcmlhVmlzdWFsaXphdGlvbik7XHJcbnNpbXVsYXRpb24uc3RhcnQoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return SuccessCriteria; });\nclass SuccessCriteria {\r\n  static centerSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 120,\r\n        y: 120,\r\n        width: 400,\r\n        height: 400,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static centerSmallSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 50,\r\n        y: 220,\r\n        width: 550,\r\n        height: 200,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static topRightCornerSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 440,\r\n        y: 0,\r\n        width: 200,\r\n        height: 200,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static topLeftCornerSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 0,\r\n        y: 0,\r\n        width: 200,\r\n        height: 200,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static bottomRightCornerSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 440,\r\n        y: 440,\r\n        width: 200,\r\n        height: 200,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static bottomLeftCornerSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 0,\r\n        y: 440,\r\n        width: 200,\r\n        height: 200,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static rightWallSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 540,\r\n        y: 0,\r\n        width: 100,\r\n        height: 640,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static leftWallSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 0,\r\n        y: 0,\r\n        width: 100,\r\n        height: 640,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static allCornersSuccess() {\r\n    return [\r\n      ...this.topLeftCornerSuccess(),\r\n      ...this.topRightCornerSuccess(),\r\n      ...this.bottomLeftCornerSuccess(),\r\n      ...this.bottomRightCornerSuccess(),\r\n    ];\r\n  }\r\n\r\n  static rightAndLeftWallSuccess() {\r\n    return [...SuccessCriteria.rightWallSuccess(), ...SuccessCriteria.leftWallSuccess()];\r\n  }\r\n\r\n  static topWallSuccess() {\r\n    return [\r\n      {\r\n        borderColour: "green",\r\n        x: 0,\r\n        y: 0,\r\n        width: 640,\r\n        height: 100,\r\n      },\r\n    ];\r\n  }\r\n\r\n  static topAndBottomWallSuccess() {\r\n    return [\r\n      ...SuccessCriteria.topWallSuccess(),\r\n      {\r\n        borderColour: "green",\r\n        x: 0,\r\n        y: 540,\r\n        width: 640,\r\n        height: 100,\r\n      },\r\n    ];\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc3VjY2Vzcy1jcml0ZXJpYS5qcz85MTU3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFN1Y2Nlc3NDcml0ZXJpYSB7XHJcbiAgc3RhdGljIGNlbnRlclN1Y2Nlc3MoKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgYm9yZGVyQ29sb3VyOiBcImdyZWVuXCIsXHJcbiAgICAgICAgeDogMTIwLFxyXG4gICAgICAgIHk6IDEyMCxcclxuICAgICAgICB3aWR0aDogNDAwLFxyXG4gICAgICAgIGhlaWdodDogNDAwLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBjZW50ZXJTbWFsbFN1Y2Nlc3MoKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgYm9yZGVyQ29sb3VyOiBcImdyZWVuXCIsXHJcbiAgICAgICAgeDogNTAsXHJcbiAgICAgICAgeTogMjIwLFxyXG4gICAgICAgIHdpZHRoOiA1NTAsXHJcbiAgICAgICAgaGVpZ2h0OiAyMDAsXHJcbiAgICAgIH0sXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHRvcFJpZ2h0Q29ybmVyU3VjY2VzcygpIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIHtcclxuICAgICAgICBib3JkZXJDb2xvdXI6IFwiZ3JlZW5cIixcclxuICAgICAgICB4OiA0NDAsXHJcbiAgICAgICAgeTogMCxcclxuICAgICAgICB3aWR0aDogMjAwLFxyXG4gICAgICAgIGhlaWdodDogMjAwLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyB0b3BMZWZ0Q29ybmVyU3VjY2VzcygpIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIHtcclxuICAgICAgICBib3JkZXJDb2xvdXI6IFwiZ3JlZW5cIixcclxuICAgICAgICB4OiAwLFxyXG4gICAgICAgIHk6IDAsXHJcbiAgICAgICAgd2lkdGg6IDIwMCxcclxuICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgfSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgYm90dG9tUmlnaHRDb3JuZXJTdWNjZXNzKCkge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAge1xyXG4gICAgICAgIGJvcmRlckNvbG91cjogXCJncmVlblwiLFxyXG4gICAgICAgIHg6IDQ0MCxcclxuICAgICAgICB5OiA0NDAsXHJcbiAgICAgICAgd2lkdGg6IDIwMCxcclxuICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgfSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgYm90dG9tTGVmdENvcm5lclN1Y2Nlc3MoKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgYm9yZGVyQ29sb3VyOiBcImdyZWVuXCIsXHJcbiAgICAgICAgeDogMCxcclxuICAgICAgICB5OiA0NDAsXHJcbiAgICAgICAgd2lkdGg6IDIwMCxcclxuICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgfSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgcmlnaHRXYWxsU3VjY2VzcygpIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIHtcclxuICAgICAgICBib3JkZXJDb2xvdXI6IFwiZ3JlZW5cIixcclxuICAgICAgICB4OiA1NDAsXHJcbiAgICAgICAgeTogMCxcclxuICAgICAgICB3aWR0aDogMTAwLFxyXG4gICAgICAgIGhlaWdodDogNjQwLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBsZWZ0V2FsbFN1Y2Nlc3MoKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgYm9yZGVyQ29sb3VyOiBcImdyZWVuXCIsXHJcbiAgICAgICAgeDogMCxcclxuICAgICAgICB5OiAwLFxyXG4gICAgICAgIHdpZHRoOiAxMDAsXHJcbiAgICAgICAgaGVpZ2h0OiA2NDAsXHJcbiAgICAgIH0sXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGFsbENvcm5lcnNTdWNjZXNzKCkge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgLi4udGhpcy50b3BMZWZ0Q29ybmVyU3VjY2VzcygpLFxyXG4gICAgICAuLi50aGlzLnRvcFJpZ2h0Q29ybmVyU3VjY2VzcygpLFxyXG4gICAgICAuLi50aGlzLmJvdHRvbUxlZnRDb3JuZXJTdWNjZXNzKCksXHJcbiAgICAgIC4uLnRoaXMuYm90dG9tUmlnaHRDb3JuZXJTdWNjZXNzKCksXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHJpZ2h0QW5kTGVmdFdhbGxTdWNjZXNzKCkge1xyXG4gICAgcmV0dXJuIFsuLi5TdWNjZXNzQ3JpdGVyaWEucmlnaHRXYWxsU3VjY2VzcygpLCAuLi5TdWNjZXNzQ3JpdGVyaWEubGVmdFdhbGxTdWNjZXNzKCldO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHRvcFdhbGxTdWNjZXNzKCkge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAge1xyXG4gICAgICAgIGJvcmRlckNvbG91cjogXCJncmVlblwiLFxyXG4gICAgICAgIHg6IDAsXHJcbiAgICAgICAgeTogMCxcclxuICAgICAgICB3aWR0aDogNjQwLFxyXG4gICAgICAgIGhlaWdodDogMTAwLFxyXG4gICAgICB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyB0b3BBbmRCb3R0b21XYWxsU3VjY2VzcygpIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIC4uLlN1Y2Nlc3NDcml0ZXJpYS50b3BXYWxsU3VjY2VzcygpLFxyXG4gICAgICB7XHJcbiAgICAgICAgYm9yZGVyQ29sb3VyOiBcImdyZWVuXCIsXHJcbiAgICAgICAgeDogMCxcclxuICAgICAgICB5OiA1NDAsXHJcbiAgICAgICAgd2lkdGg6IDY0MCxcclxuICAgICAgICBoZWlnaHQ6IDEwMCxcclxuICAgICAgfSxcclxuICAgIF07XHJcbiAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///1\n')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuccessCriteriaVisualization", function() { return SuccessCriteriaVisualization; });\nclass SuccessCriteriaVisualization {\r\n  constructor(successCriteria) {\r\n    this.successCriteria = successCriteria;\r\n  }\r\n\r\n  drawer(ctx) {\r\n    this.successCriteria.forEach((criteria) => {\r\n      ctx.lineWidth = 3;\r\n      ctx.strokeStyle = criteria.borderColour;\r\n      ctx.beginPath();\r\n      ctx.rect(criteria.x, criteria.y, criteria.width, criteria.height);\r\n      ctx.stroke();\r\n    });\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc3VjY2Vzcy1jcml0ZXJpYS12aXN1YWxpemF0aW9uLmpzP2Y1ZDkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBTdWNjZXNzQ3JpdGVyaWFWaXN1YWxpemF0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihzdWNjZXNzQ3JpdGVyaWEpIHtcclxuICAgIHRoaXMuc3VjY2Vzc0NyaXRlcmlhID0gc3VjY2Vzc0NyaXRlcmlhO1xyXG4gIH1cclxuXHJcbiAgZHJhd2VyKGN0eCkge1xyXG4gICAgdGhpcy5zdWNjZXNzQ3JpdGVyaWEuZm9yRWFjaCgoY3JpdGVyaWEpID0+IHtcclxuICAgICAgY3R4LmxpbmVXaWR0aCA9IDM7XHJcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGNyaXRlcmlhLmJvcmRlckNvbG91cjtcclxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICBjdHgucmVjdChjcml0ZXJpYS54LCBjcml0ZXJpYS55LCBjcml0ZXJpYS53aWR0aCwgY3JpdGVyaWEuaGVpZ2h0KTtcclxuICAgICAgY3R4LnN0cm9rZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/creature.js\nclass Creature {\r\n  constructor(genome, neuralNetwork, startingX, startingY, dimension, gameWidth, gameHeight, speed, drawInfo) {\r\n    this.fitness = -1;\r\n    this.genome = genome;\r\n    this.neuralNetwork = neuralNetwork;\r\n    this.gameWidth = gameWidth;\r\n    this.gameHeight = gameHeight;\r\n    this.speed = speed;\r\n    this.drawInfo = drawInfo;\r\n    this.dimensions = {\r\n      width: dimension,\r\n      height: dimension,\r\n    };\r\n\r\n    this.position = {\r\n      x: startingX,\r\n      y: startingY,\r\n    };\r\n\r\n    this.generateColour();\r\n  }\r\n\r\n  setFitness(fitness) {\r\n    if (this.fitness === -1) {\r\n      this.fitness = fitness;\r\n    }\r\n  }\r\n\r\n  scaleValue(value, xMin, xMax, yMin, yMax) {\r\n    var percent = (value - yMin) / (yMax - yMin);\r\n    return percent * (xMax - xMin) + xMin;\r\n  }\r\n\r\n  getRandomColour(scaledGenomeNumber) {\r\n    return `#${Math.floor(scaledGenomeNumber * 16777215).toString(16)}`;\r\n  }\r\n\r\n  generateColour() {\r\n    var genomeColour =\r\n      this.genome.chromosomes.reduce((lastValue, currentValue) => {\r\n        lastValue ^= currentValue;\r\n        return lastValue >>> 0;\r\n      }, this.genome.chromosomes[0]) >>> 0;\r\n\r\n    var scaledGenomeColour = this.scaleValue(genomeColour, 0, 1, 0, 4294967295); // Max value of unsigned 32 bit int... 4294967295\r\n    this.colour = this.getRandomColour(scaledGenomeColour);\r\n  }\r\n\r\n  drawerLable(ctx) {\r\n    ctx.fillText(`${this.genome.toString()}`, this.position.x - 10, this.position.y - 10);\r\n  }\r\n\r\n  drawer(ctx) {\r\n    ctx.fillStyle = this.colour;\r\n    ctx.beginPath();\r\n    ctx.ellipse(\r\n      this.position.x + this.dimensions.width / 2,\r\n      this.position.y + this.dimensions.height / 2,\r\n      this.dimensions.width / 2,\r\n      this.dimensions.height / 2,\r\n      0,\r\n      0,\r\n      2 * Math.PI\r\n    );\r\n    ctx.fill();\r\n    ctx.closePath();\r\n    if (this.drawInfo) {\r\n      this.drawerLable(ctx);\r\n    }\r\n  }\r\n\r\n  update(actionProbabilities) {\r\n    const currentPosition = {\r\n      ...this.position,\r\n    };\r\n\r\n    if (actionProbabilities.length > 0) {\r\n      var bestAction = actionProbabilities.filter((action) => Math.random() < action.getValue()).sort((a, b) => b - a);\r\n      //console.log(bestAction.getValue());\r\n\r\n      if (bestAction[0]) {\r\n        bestAction[0].applyAction(this);\r\n      }\r\n      if (\r\n        this.position.x < 0 ||\r\n        this.position.x >= this.gameWidth * this.dimensions.width ||\r\n        this.position.y < 0 ||\r\n        this.position.y >= this.gameHeight * this.dimensions.height\r\n      ) {\r\n        //console.log("Hit Edge");\r\n        this.position = currentPosition;\r\n      }\r\n    }\r\n  }\r\n\r\n  updateAndRedrawer(ctx) {\r\n    var actionProbabilities = this.neuralNetwork.feedForward(this);\r\n    this.update(actionProbabilities);\r\n    this.drawer(ctx);\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/game.js\nclass Game {\r\n  constructor(GAME_HEIGHT, GAME_WIDTH, DIVISION_SIZE, SHOW_GRAPH, successCriteria) {\r\n    this.height = GAME_HEIGHT;\r\n    this.width = GAME_WIDTH;\r\n    this.divisionSize = DIVISION_SIZE;\r\n    this.showGraph = SHOW_GRAPH;\r\n    this.successCriteriaVisualization = successCriteria;\r\n    this.gameCreatures = [];\r\n\r\n    this.canvas = document.createElement("canvas");\r\n    this.canvas.setAttribute("id", "canvas");\r\n    this.canvas.setAttribute("width", GAME_WIDTH * DIVISION_SIZE);\r\n    this.canvas.setAttribute("height", GAME_HEIGHT * DIVISION_SIZE);\r\n    this.canvas.setAttribute("style", "border: 1px solid black; box-sizing: border-box");\r\n    document.body.appendChild(this.canvas);\r\n    this.ctx = canvas.getContext("2d");\r\n  }\r\n\r\n  addCreature(creature) {\r\n    this.gameCreatures.push(creature);\r\n  }\r\n\r\n  getSurvivors(successCriteria) {\r\n    return this.gameCreatures\r\n      .filter((c) => {\r\n        return successCriteria.some((criteria) => {\r\n          const xBottom = criteria.x + criteria.width;\r\n          const yBottom = criteria.y + criteria.height;\r\n          return c.position.x >= criteria.x && c.position.y >= criteria.y && c.position.x <= xBottom && c.position.y <= yBottom;\r\n        });\r\n      })\r\n      .sort((a, b) => {\r\n        if (a.fitness === 1) {\r\n          return 1;\r\n        }\r\n\r\n        a.fitness - b.fitness;\r\n      });\r\n  }\r\n\r\n  creatureHasMadeItHome(creature, successCriteria) {\r\n    return successCriteria.some((criteria) => {\r\n      const xBottom = criteria.x + criteria.width;\r\n      const yBottom = criteria.y + criteria.height;\r\n      return (\r\n        creature.position.x >= criteria.x &&\r\n        creature.position.y >= criteria.y &&\r\n        creature.position.x <= xBottom &&\r\n        creature.position.y <= yBottom\r\n      );\r\n    });\r\n  }\r\n\r\n  drawGrid() {\r\n    this.ctx.lineWidth = 0.5;\r\n    // Do columns\r\n    for (let index = this.divisionSize; index < this.width * this.divisionSize; index += this.divisionSize) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(index, 0);\r\n      this.ctx.lineTo(index, this.height * this.divisionSize);\r\n      this.ctx.stroke();\r\n      this.ctx.closePath();\r\n    }\r\n\r\n    // Do Rows\r\n    for (let index = this.divisionSize; index < this.height * this.divisionSize; index += this.divisionSize) {\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(0, index);\r\n      this.ctx.lineTo(this.width * this.divisionSize, index);\r\n      this.ctx.stroke();\r\n      this.ctx.closePath();\r\n    }\r\n  }\r\n\r\n  update(currentStepCount) {\r\n    this.ctx.fillStyle = "white";\r\n    this.ctx.fillRect(0, 0, this.width * this.divisionSize, this.height * this.divisionSize);\r\n    this.gameCreatures.forEach((creature) => {\r\n      creature.updateAndRedrawer(this.ctx);\r\n      if (creature.fitness === -1 && this.creatureHasMadeItHome(creature, this.successCriteriaVisualization.successCriteria)) {\r\n        creature.setFitness(currentStepCount);\r\n      }\r\n    });\r\n\r\n    if (this.showGraph) {\r\n      this.drawGrid();\r\n    }\r\n\r\n    this.successCriteriaVisualization.drawer(this.ctx);\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/bit-operations.js\nfunction checkBit(number, bitToCheck) {\r\n  var mask = (1 << bitToCheck) >>> 0;\r\n  var result = (number & mask) >>> 0;\r\n  return result !== 0;\r\n}\r\n\r\nfunction slice(number, start, end) {\r\n  var mask = Math.pow(2, end - start + 1) - 1;\r\n  mask = mask << start;\r\n  var result = number & mask;\r\n  return result >> start;\r\n}\r\n\r\nfunction flipBit(number, bitToFlip) {\r\n  if (checkBit(number, bitToFlip)) {\r\n    // bit is on\r\n    var mask = 1 << bitToFlip;\r\n    // invert mask then and\r\n    mask = ~mask;\r\n    return (number & mask) >>> 0;\r\n  }\r\n\r\n  // bit is off\r\n  var mask = 1 << bitToFlip;\r\n  return (number | mask) >>> 0;\r\n}\r\n\n// CONCATENATED MODULE: ./src/genome.js\n\r\n\r\nclass genome_Genome {\r\n  constructor(size, generateRandomValues = true) {\r\n    if (size % 2 !== 0) {\r\n      throw "Genome size must be an even number.";\r\n    }\r\n    this.size = size;\r\n    this.chromosomes = new Uint32Array(size);\r\n    if (generateRandomValues) {\r\n      window.crypto.getRandomValues(this.chromosomes);\r\n    }\r\n  }\r\n\r\n  static createNewGenomeFromParents(genomeOne, genomeTwo, mutationRate) {\r\n    var takeFromParentOneFirst = Math.random() > 0.5;\r\n    var size = genomeOne.size;\r\n    var newGenome = new genome_Genome(size, false);\r\n    for (let index = 0; index < size; index++) {\r\n      if (takeFromParentOneFirst) {\r\n        newGenome.chromosomes[index] = genomeOne.chromosomes[index];\r\n      } else {\r\n        newGenome.chromosomes[index] = genomeTwo.chromosomes[index];\r\n      }\r\n\r\n      var mutationShouldOccure = Math.random() < mutationRate;\r\n      if (mutationShouldOccure) {\r\n        var originalChromosome = newGenome.chromosomes[index];\r\n        var bitToFlip = Math.floor(Math.random() * 32) + 1;\r\n        var mutatedChromosome = flipBit(originalChromosome, bitToFlip);\r\n        console.log(\r\n          `Mutation occured on bit ${bitToFlip}, change from ${(originalChromosome >>> 0).toString(2)} to ${(\r\n            mutatedChromosome >>> 0\r\n          ).toString(2)}.`\r\n        );\r\n        newGenome.chromosomes[index] = mutatedChromosome;\r\n      }\r\n\r\n      takeFromParentOneFirst = !takeFromParentOneFirst;\r\n    }\r\n\r\n    return newGenome;\r\n  }\r\n\r\n  toString() {\r\n    return this.chromosomes.join(":");\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/neuron.js\nclass Neuron {\r\n  constructor(type, game) {\r\n    this.type = type;\r\n    this.game = game;\r\n    this.connections = [];\r\n    this.lastValue = 0;\r\n  }\r\n\r\n  scaleValue(value, xMin, xMax, yMin, yMax) {\r\n    var percent = (value - yMin) / (yMax - yMin);\r\n    return percent * (xMax - xMin) + xMin;\r\n  }\r\n\r\n  addConnection(connection) {\r\n    this.connections.push(connection);\r\n  }\r\n\r\n  updateLastValue(lastValue) {\r\n    this.lastValue = lastValue;\r\n  }\r\n\r\n  getValue(creature) {\r\n    return this.lastValue;\r\n  }\r\n\r\n  applyAction(creature) {\r\n    return;\r\n  }\r\n\r\n  toString() {\r\n    return `${this.type}`;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/inputs/SensitivityToProximityToEast.js\n\r\n\r\nclass SensitivityToProximityToEast_SensitivityToProximityToEast extends Neuron {\r\n  constructor(game) {\r\n    super("SensitivityToProximityToEast", game);\r\n  }\r\n\r\n  getValue(creature) {\r\n    var scaledGameWidth = this.game.width * this.game.divisionSize;\r\n    var scaledInput = this.scaleValue(creature.position.x, 0, 1, 0, scaledGameWidth);\r\n    return scaledInput;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/inputs/SensitivityToProximityToWest.js\n\r\n\r\nclass SensitivityToProximityToWest_SensitivityToProximityToWest extends Neuron {\r\n  constructor(game) {\r\n    super("SensitivityToProximityToWest", game);\r\n  }\r\n\r\n  getValue(creature) {\r\n    var scaledGameWidth = this.game.width * this.game.divisionSize;\r\n    var invertedX = scaledGameWidth - creature.position.x;\r\n    var scaledInput = this.scaleValue(invertedX, 0, 1, 0, scaledGameWidth);\r\n    return scaledInput;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/inputs/SensitivityToProximityToSouth.js\n\r\n\r\nclass SensitivityToProximityToSouth_SensitivityToProximityToSouth extends Neuron {\r\n  constructor(game) {\r\n    super("SensitivityToProximityToSouth", game);\r\n  }\r\n\r\n  getValue(creature) {\r\n    var scaledGameHeight = this.game.height * this.game.divisionSize;\r\n    var scaledInput = this.scaleValue(creature.position.y, 0, 1, 0, scaledGameHeight);\r\n    return scaledInput;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/inputs/SensitivityToProximityToNorth.js\n\r\n\r\nclass SensitivityToProximityToNorth_SensitivityToProximityToNorth extends Neuron {\r\n  constructor(game) {\r\n    super("SensitivityToProximityToNorth", game);\r\n  }\r\n\r\n  /*\r\n    if creature.y = 0 return 1\r\n    if creature.y = 128 return 0\r\n  */\r\n  getValue(creature) {\r\n    var scaledGameHeight = this.game.height * this.game.divisionSize;\r\n    var invertedY = scaledGameHeight - creature.position.y;\r\n    var scaledInput = this.scaleValue(invertedY, 0, 1, 0, scaledGameHeight);\r\n    return scaledInput;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/connection.js\nclass Connection {\r\n  constructor(source, sink, weight) {\r\n    this.source = source;\r\n    this.sink = sink;\r\n    this.weight = weight;\r\n  }\r\n\r\n  toString() {\r\n    return `${this.source}:${this.sink}:${this.weight}`;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoNorth.js\n\r\n\r\nclass GoNorth_GoNorth extends Neuron {\r\n  constructor() {\r\n    super("GoNorth");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.y -= creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoNorthEast.js\n\r\n\r\nclass GoNorthEast_GoNorthEast extends Neuron {\r\n  constructor() {\r\n    super("GoNorthEast");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.y -= creature.speed * creature.dimensions.width;\r\n    creature.position.x += creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoEast.js\n\r\n\r\nclass GoEast_GoEast extends Neuron {\r\n  constructor() {\r\n    super("GoEast");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.x += creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoSouthEast.js\n\r\n\r\nclass GoSouthEast_GoSouthEast extends Neuron {\r\n  constructor() {\r\n    super("GoSouthEast");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.x += creature.speed * creature.dimensions.width;\r\n    creature.position.y += creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoSouth.js\n\r\n\r\nclass GoSouth_GoSouth extends Neuron {\r\n  constructor() {\r\n    super("GoSouth");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.y += creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoSouthWest.js\n\r\n\r\nclass GoSouthWest_GoSouthWest extends Neuron {\r\n  constructor() {\r\n    super("GoSouthWest");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.y += creature.speed * creature.dimensions.width;\r\n    creature.position.x -= creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoWest.js\n\r\n\r\nclass GoWest_GoWest extends Neuron {\r\n  constructor() {\r\n    super("GoWest");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.x -= creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/GoNorthWest.js\n\r\n\r\nclass GoNorthWest_GoNorthWest extends Neuron {\r\n  constructor() {\r\n    super("GoNorthWest");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    creature.position.y -= creature.speed * creature.dimensions.width;\r\n    creature.position.x -= creature.speed * creature.dimensions.width;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/outputs/DoNothing.js\n\r\n\r\nclass DoNothing_DoNothing extends Neuron {\r\n  constructor() {\r\n    super("DoNothing");\r\n  }\r\n\r\n  applyAction(creature) {\r\n    return;\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/nn/neural-network.js\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass neural_network_NeuralNetwork {\r\n  constructor(numberOfHiddenNeurons, genome, sensitivityNeuronFactory) {\r\n    this.genome = genome;\r\n    this.hiddenNeurons = new Array(numberOfHiddenNeurons);\r\n\r\n    for (let index = 0; index < this.hiddenNeurons.length; index++) {\r\n      this.hiddenNeurons[index] = new Neuron(`Hidden Layer ${index}`);\r\n    }\r\n\r\n    this.inputNeurons = [\r\n      sensitivityNeuronFactory("SensitivityToProximityToEast"),\r\n      sensitivityNeuronFactory("SensitivityToProximityToNorth"),\r\n      sensitivityNeuronFactory("SensitivityToProximityToSouth"),\r\n      sensitivityNeuronFactory("SensitivityToProximityToWest"),\r\n    ];\r\n\r\n    this.outputNeurons = [\r\n      new DoNothing_DoNothing(),\r\n      new GoNorth_GoNorth(),\r\n      new GoNorthEast_GoNorthEast(),\r\n      new GoEast_GoEast(),\r\n      new GoSouthEast_GoSouthEast(),\r\n      new GoSouth_GoSouth(),\r\n      new GoSouthWest_GoSouthWest(),\r\n      new GoWest_GoWest(),\r\n      new GoNorthWest_GoNorthWest(),\r\n    ];\r\n\r\n    for (let index = 0; index < this.genome.size; index++) {\r\n      var chromosome = this.genome.chromosomes[index];\r\n      this.addConnection(chromosome);\r\n    }\r\n  }\r\n\r\n  scaleWeight(weight, xMin, xMax, yMin, yMax) {\r\n    var percent = (weight - yMin) / (yMax - yMin);\r\n    return percent * (xMax - xMin) + xMin;\r\n  }\r\n\r\n  // first bit is source type (i.e 0 = sensor neuron, or 1 hidden neuron)\r\n  // next 5 bits determine which instance of that source type we have\r\n  // next bit is the sink type (i.e an internal neuron or an action/output neuron)\r\n  // next 20 bits is the weight of the connection\r\n\r\n  //      31| 30-26 | 25| 24-20 |19-----------------0\r\n  //       1| 01110 | 0 | 11000 |10010111001011000101\r\n  //E.g.   0| 00011 | 0 | 01100 |11001100110011001100\r\n  //                             10000000000000000000\r\n  //                             11111111111111111111 = 0 to 1048575\r\n  addConnection(chromosome) {\r\n    var sourceIsAnInputNeuron = checkBit(chromosome, 31); // 0 based index on the bits, i.e. 0 is furthest right (least significant bit)\r\n    var getSourceInstance = slice(chromosome, 26, 30) % (sourceIsAnInputNeuron ? this.inputNeurons.length : this.hiddenNeurons.length);\r\n    var sinkIsAnOutputNeuron = checkBit(chromosome, 25);\r\n    var getOutputInstance = slice(chromosome, 20, 24) % (sinkIsAnOutputNeuron ? this.outputNeurons.length : this.hiddenNeurons.length);\r\n    var weight = this.scaleWeight(slice(chromosome, 0, 19), -4, 4, 0, 1048575);\r\n\r\n    var source;\r\n    var sink;\r\n\r\n    if (sourceIsAnInputNeuron) {\r\n      // get the sensor type\r\n      source = this.inputNeurons[getSourceInstance];\r\n    } else {\r\n      // this is a hidden layer neuron\r\n      source = this.hiddenNeurons[getSourceInstance];\r\n    }\r\n\r\n    if (sinkIsAnOutputNeuron) {\r\n      // get the action type\r\n      sink = this.outputNeurons[getOutputInstance];\r\n    } else {\r\n      // this is a hidden layer neuron\r\n      sink = this.hiddenNeurons[getOutputInstance];\r\n    }\r\n\r\n    sink.addConnection(new Connection(source, sink, weight));\r\n  }\r\n\r\n  feedForward(creature) {\r\n    // Only return output neurons with a positive "probability"\r\n    return this.outputNeurons.filter((n) => {\r\n      var outputForN = this.feedForwardPer(n, creature);\r\n      n.updateLastValue(outputForN);\r\n      return outputForN > 0;\r\n    });\r\n  }\r\n\r\n  feedForwardPer(neuron, creature) {\r\n    var depth = 0;\r\n\r\n    let getInput = (connection, seenNodes) => {\r\n      depth++;\r\n      if (depth > 15) {\r\n        //debugger;\r\n      }\r\n      // this connection has a source and a weight, need to get the source input value * weight and return that\r\n      var sink = connection.sink;\r\n      var source = connection.source;\r\n      var weight = connection.weight;\r\n      seenNodes.set(sink, sink.getValue(creature));\r\n\r\n      if (seenNodes.has(source)) {\r\n        return seenNodes.get(source);\r\n      } else if (source.connections.length === 0) {\r\n        // we\'re at the top of the tree so return the value of the input * weight\r\n        var input = source.getValue(creature);\r\n        return input * weight;\r\n      } else {\r\n        // we still have more connections to get\r\n        var sumOfWeightedInputs = 0;\r\n        for (let index = 0; index < source.connections.length; index++) {\r\n          const connection = source.connections[index];\r\n          sumOfWeightedInputs += getInput(connection, seenNodes);\r\n        }\r\n\r\n        return Math.tanh(sumOfWeightedInputs);\r\n      }\r\n    };\r\n\r\n    var sumOfWeightedInputs = 0;\r\n    for (let index = 0; index < neuron.connections.length; index++) {\r\n      const seenNodes = new Map();\r\n      const connection = neuron.connections[index];\r\n      sumOfWeightedInputs += getInput(connection, seenNodes);\r\n    }\r\n    return Math.tanh(sumOfWeightedInputs);\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/simulation.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return simulation_Simulation; });\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass simulation_Simulation {\r\n  constructor(\r\n    sizeOfPopulation,\r\n    numberOfGenerationsToRun,\r\n    movesPerGeneration,\r\n    framesPerSecond,\r\n    sizeOfGenome,\r\n    numberOfNeuronsInHiddenLayer,\r\n    mutationRate,\r\n    successCriteriaVisualization\r\n  ) {\r\n    this.sizeOfPopulation = sizeOfPopulation;\r\n    this.numberOfGenerationsToRun = numberOfGenerationsToRun;\r\n    this.movesPerGeneration = movesPerGeneration;\r\n    this.framesPerSecond = framesPerSecond;\r\n    this.sizeOfGenome = sizeOfGenome;\r\n    this.numberOfNeuronsInHiddenLayer = numberOfNeuronsInHiddenLayer;\r\n    this.mutationRate = mutationRate;\r\n    this.successCriteriaVisualization = successCriteriaVisualization;\r\n\r\n    this._sensitivityNeuronFactory = (game) => (type) => {\r\n      switch (type) {\r\n        case "SensitivityToProximityToEast":\r\n          return new SensitivityToProximityToEast_SensitivityToProximityToEast(game);\r\n        case "SensitivityToProximityToWest":\r\n          return new SensitivityToProximityToWest_SensitivityToProximityToWest(game);\r\n        case "SensitivityToProximityToSouth":\r\n          return new SensitivityToProximityToSouth_SensitivityToProximityToSouth(game);\r\n        case "SensitivityToProximityToNorth":\r\n          return new SensitivityToProximityToNorth_SensitivityToProximityToNorth(game);\r\n        default:\r\n          break;\r\n      }\r\n    };\r\n\r\n    this.currentStepCount = 0;\r\n    this.currentGenerationCount = 0;\r\n    this.generationCountLabel = document.createElement("h1");\r\n    document.body.appendChild(this.generationCountLabel);\r\n    this.stepCountLabel = document.createElement("h1");\r\n    document.body.appendChild(this.stepCountLabel);\r\n  }\r\n\r\n  _randomNumberBetween(min, max) {\r\n    return Math.floor(Math.random() * (max - min) + 1);\r\n  }\r\n\r\n  _roundToNearest(numberToRound, valueToNearest) {\r\n    return Math.ceil(numberToRound / valueToNearest) * valueToNearest;\r\n  }\r\n\r\n  _getPositionWithin(game) {\r\n    return this._roundToNearest(this._randomNumberBetween(0, game.width * game.divisionSize - game.divisionSize), game.divisionSize);\r\n  }\r\n\r\n  _initialiseGame() {\r\n    this.game = new Game(128, 128, 5, false, this.successCriteriaVisualization);\r\n  }\r\n\r\n  _generateInitialCohort() {\r\n    for (let index = 0; index < this.sizeOfPopulation; index++) {\r\n      // 0,0 to 635,635\r\n      const genome = new genome_Genome(this.sizeOfGenome);\r\n      const neuralNetwork = new neural_network_NeuralNetwork(this.numberOfNeuronsInHiddenLayer, genome, this._sensitivityNeuronFactory(this.game));\r\n      const creature = new Creature(\r\n        genome,\r\n        neuralNetwork,\r\n        this._getPositionWithin(this.game),\r\n        this._getPositionWithin(this.game),\r\n        this.game.divisionSize,\r\n        this.game.width,\r\n        this.game.height,\r\n        1,\r\n        false\r\n      );\r\n      this.game.addCreature(creature);\r\n    }\r\n  }\r\n\r\n  _generateNextCohort(survivors) {\r\n    this.game.gameCreatures = [];\r\n    for (let indexOne = 0, indexTwo = 2; indexTwo < survivors.length; indexOne++, indexTwo++) {\r\n      if (this.game.gameCreatures.length > this.sizeOfPopulation) {\r\n        console.log("Hit population limit");\r\n        break;\r\n      }\r\n      const parentOne = survivors[indexOne];\r\n      const parentTwo = survivors[indexOne + 1];\r\n      const parentOneGenome = parentOne.genome;\r\n      const parentTwoGenome = parentTwo.genome;\r\n      var childGenomeOne = genome_Genome.createNewGenomeFromParents(parentOneGenome, parentTwoGenome, this.mutationRate);\r\n      var childGenomeTwo = genome_Genome.createNewGenomeFromParents(parentTwoGenome, parentOneGenome, this.mutationRate);\r\n      const neuralNetworkOne = new neural_network_NeuralNetwork(\r\n        this.numberOfNeuronsInHiddenLayer,\r\n        childGenomeOne,\r\n        this._sensitivityNeuronFactory(this.game)\r\n      );\r\n      const neuralNetworkTwo = new neural_network_NeuralNetwork(\r\n        this.numberOfNeuronsInHiddenLayer,\r\n        childGenomeTwo,\r\n        this._sensitivityNeuronFactory(this.game)\r\n      );\r\n\r\n      const creatureOne = new Creature(\r\n        childGenomeOne,\r\n        neuralNetworkOne,\r\n        this._getPositionWithin(this.game),\r\n        this._getPositionWithin(this.game),\r\n        this.game.divisionSize,\r\n        this.game.width,\r\n        this.game.height,\r\n        1,\r\n        false\r\n      );\r\n\r\n      const creatureTwo = new Creature(\r\n        childGenomeTwo,\r\n        neuralNetworkTwo,\r\n        this._getPositionWithin(this.game),\r\n        this._getPositionWithin(this.game),\r\n        this.game.divisionSize,\r\n        this.game.width,\r\n        this.game.height,\r\n        1,\r\n        false\r\n      );\r\n\r\n      this.game.addCreature(creatureOne);\r\n      this.game.addCreature(creatureTwo);\r\n    }\r\n  }\r\n\r\n  _animate() {\r\n    this.stepCountLabel.innerText = `Generation Step Count: ${this.currentStepCount++}`;\r\n    this.game.update(this.currentStepCount);\r\n    if (this.currentStepCount <= this.movesPerGeneration) {\r\n      setTimeout(() => requestAnimationFrame(this._animate.bind(this)), 1000 / this.framesPerSecond);\r\n    } else {\r\n      // This generation has finished, time to get the survivors to reproduce\r\n      // Then set the board back with the new generation\r\n      this.generationCountLabel.innerText = `Gen ${++this.currentGenerationCount}`;\r\n      const survivors = this.game.getSurvivors(this.successCriteriaVisualization.successCriteria);\r\n      console.log(`Number of survivors ${survivors.length}.`);\r\n      this._generateNextCohort(survivors);\r\n      this.currentStepCount = 0;\r\n      this._animate();\r\n    }\r\n  }\r\n\r\n  start() {\r\n    this.generationCountLabel.innerText = `Gen ${this.currentGenerationCount}`;\r\n    this._initialiseGame();\r\n    this._generateInitialCohort();\r\n    this._animate();\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY3JlYXR1cmUuanM/MDE0YyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZS5qcz83ZGUwIiwid2VicGFjazovLy8uL3NyYy9iaXQtb3BlcmF0aW9ucy5qcz9iMGVmIiwid2VicGFjazovLy8uL3NyYy9nZW5vbWUuanM/ZGZjNSIsIndlYnBhY2s6Ly8vLi9zcmMvbm4vbmV1cm9uLmpzP2VlNDciLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9FYXN0LmpzPzI1NDAiLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9XZXN0LmpzP2I2NWQiLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9Tb3V0aC5qcz81NjdjIiwid2VicGFjazovLy8uL3NyYy9ubi9pbnB1dHMvU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvTm9ydGguanM/ZTJjZiIsIndlYnBhY2s6Ly8vLi9zcmMvbm4vY29ubmVjdGlvbi5qcz9iMjc0Iiwid2VicGFjazovLy8uL3NyYy9ubi9vdXRwdXRzL0dvTm9ydGguanM/MmZhZCIsIndlYnBhY2s6Ly8vLi9zcmMvbm4vb3V0cHV0cy9Hb05vcnRoRWFzdC5qcz8zZDBmIiwid2VicGFjazovLy8uL3NyYy9ubi9vdXRwdXRzL0dvRWFzdC5qcz80NWQxIiwid2VicGFjazovLy8uL3NyYy9ubi9vdXRwdXRzL0dvU291dGhFYXN0LmpzP2VhYjkiLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL291dHB1dHMvR29Tb3V0aC5qcz85OTRkIiwid2VicGFjazovLy8uL3NyYy9ubi9vdXRwdXRzL0dvU291dGhXZXN0LmpzP2JlYTMiLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL291dHB1dHMvR29XZXN0LmpzPzY2MTAiLCJ3ZWJwYWNrOi8vLy4vc3JjL25uL291dHB1dHMvR29Ob3J0aFdlc3QuanM/ODY4MiIsIndlYnBhY2s6Ly8vLi9zcmMvbm4vb3V0cHV0cy9Eb05vdGhpbmcuanM/ZjUxZSIsIndlYnBhY2s6Ly8vLi9zcmMvbm4vbmV1cmFsLW5ldHdvcmsuanM/MDU0OCIsIndlYnBhY2s6Ly8vLi9zcmMvc2ltdWxhdGlvbi5qcz9jOTNkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsdURBQXVEO0FBQ3RFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQLGdGQUFnRjtBQUNoRjtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CLHVCQUF1QjtBQUMzQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNwR2U7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFtQyw0QkFBYTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw4QkFBOEIsUUFBUTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw4QkFBOEIsUUFBUTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUE4RCx3QkFBd0I7QUFDdEY7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxtREFBbUQsOEJBQThCO0FBQ2pGO0FBQ0EseUNBQXlDLGlCQUFpQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaURBQWlELDRCQUE0QjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDcmVhdHVyZSB7XHJcbiAgY29uc3RydWN0b3IoZ2Vub21lLCBuZXVyYWxOZXR3b3JrLCBzdGFydGluZ1gsIHN0YXJ0aW5nWSwgZGltZW5zaW9uLCBnYW1lV2lkdGgsIGdhbWVIZWlnaHQsIHNwZWVkLCBkcmF3SW5mbykge1xyXG4gICAgdGhpcy5maXRuZXNzID0gLTE7XHJcbiAgICB0aGlzLmdlbm9tZSA9IGdlbm9tZTtcclxuICAgIHRoaXMubmV1cmFsTmV0d29yayA9IG5ldXJhbE5ldHdvcms7XHJcbiAgICB0aGlzLmdhbWVXaWR0aCA9IGdhbWVXaWR0aDtcclxuICAgIHRoaXMuZ2FtZUhlaWdodCA9IGdhbWVIZWlnaHQ7XHJcbiAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XHJcbiAgICB0aGlzLmRyYXdJbmZvID0gZHJhd0luZm87XHJcbiAgICB0aGlzLmRpbWVuc2lvbnMgPSB7XHJcbiAgICAgIHdpZHRoOiBkaW1lbnNpb24sXHJcbiAgICAgIGhlaWdodDogZGltZW5zaW9uLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnBvc2l0aW9uID0ge1xyXG4gICAgICB4OiBzdGFydGluZ1gsXHJcbiAgICAgIHk6IHN0YXJ0aW5nWSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZW5lcmF0ZUNvbG91cigpO1xyXG4gIH1cclxuXHJcbiAgc2V0Rml0bmVzcyhmaXRuZXNzKSB7XHJcbiAgICBpZiAodGhpcy5maXRuZXNzID09PSAtMSkge1xyXG4gICAgICB0aGlzLmZpdG5lc3MgPSBmaXRuZXNzO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2NhbGVWYWx1ZSh2YWx1ZSwgeE1pbiwgeE1heCwgeU1pbiwgeU1heCkge1xyXG4gICAgdmFyIHBlcmNlbnQgPSAodmFsdWUgLSB5TWluKSAvICh5TWF4IC0geU1pbik7XHJcbiAgICByZXR1cm4gcGVyY2VudCAqICh4TWF4IC0geE1pbikgKyB4TWluO1xyXG4gIH1cclxuXHJcbiAgZ2V0UmFuZG9tQ29sb3VyKHNjYWxlZEdlbm9tZU51bWJlcikge1xyXG4gICAgcmV0dXJuIGAjJHtNYXRoLmZsb29yKHNjYWxlZEdlbm9tZU51bWJlciAqIDE2Nzc3MjE1KS50b1N0cmluZygxNil9YDtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ29sb3VyKCkge1xyXG4gICAgdmFyIGdlbm9tZUNvbG91ciA9XHJcbiAgICAgIHRoaXMuZ2Vub21lLmNocm9tb3NvbWVzLnJlZHVjZSgobGFzdFZhbHVlLCBjdXJyZW50VmFsdWUpID0+IHtcclxuICAgICAgICBsYXN0VmFsdWUgXj0gY3VycmVudFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBsYXN0VmFsdWUgPj4+IDA7XHJcbiAgICAgIH0sIHRoaXMuZ2Vub21lLmNocm9tb3NvbWVzWzBdKSA+Pj4gMDtcclxuXHJcbiAgICB2YXIgc2NhbGVkR2Vub21lQ29sb3VyID0gdGhpcy5zY2FsZVZhbHVlKGdlbm9tZUNvbG91ciwgMCwgMSwgMCwgNDI5NDk2NzI5NSk7IC8vIE1heCB2YWx1ZSBvZiB1bnNpZ25lZCAzMiBiaXQgaW50Li4uIDQyOTQ5NjcyOTVcclxuICAgIHRoaXMuY29sb3VyID0gdGhpcy5nZXRSYW5kb21Db2xvdXIoc2NhbGVkR2Vub21lQ29sb3VyKTtcclxuICB9XHJcblxyXG4gIGRyYXdlckxhYmxlKGN0eCkge1xyXG4gICAgY3R4LmZpbGxUZXh0KGAke3RoaXMuZ2Vub21lLnRvU3RyaW5nKCl9YCwgdGhpcy5wb3NpdGlvbi54IC0gMTAsIHRoaXMucG9zaXRpb24ueSAtIDEwKTtcclxuICB9XHJcblxyXG4gIGRyYXdlcihjdHgpIHtcclxuICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLmNvbG91cjtcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5lbGxpcHNlKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnggKyB0aGlzLmRpbWVuc2lvbnMud2lkdGggLyAyLFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnkgKyB0aGlzLmRpbWVuc2lvbnMuaGVpZ2h0IC8gMixcclxuICAgICAgdGhpcy5kaW1lbnNpb25zLndpZHRoIC8gMixcclxuICAgICAgdGhpcy5kaW1lbnNpb25zLmhlaWdodCAvIDIsXHJcbiAgICAgIDAsXHJcbiAgICAgIDAsXHJcbiAgICAgIDIgKiBNYXRoLlBJXHJcbiAgICApO1xyXG4gICAgY3R4LmZpbGwoKTtcclxuICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgIGlmICh0aGlzLmRyYXdJbmZvKSB7XHJcbiAgICAgIHRoaXMuZHJhd2VyTGFibGUoY3R4KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHVwZGF0ZShhY3Rpb25Qcm9iYWJpbGl0aWVzKSB7XHJcbiAgICBjb25zdCBjdXJyZW50UG9zaXRpb24gPSB7XHJcbiAgICAgIC4uLnRoaXMucG9zaXRpb24sXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChhY3Rpb25Qcm9iYWJpbGl0aWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdmFyIGJlc3RBY3Rpb24gPSBhY3Rpb25Qcm9iYWJpbGl0aWVzLmZpbHRlcigoYWN0aW9uKSA9PiBNYXRoLnJhbmRvbSgpIDwgYWN0aW9uLmdldFZhbHVlKCkpLnNvcnQoKGEsIGIpID0+IGIgLSBhKTtcclxuICAgICAgLy9jb25zb2xlLmxvZyhiZXN0QWN0aW9uLmdldFZhbHVlKCkpO1xyXG5cclxuICAgICAgaWYgKGJlc3RBY3Rpb25bMF0pIHtcclxuICAgICAgICBiZXN0QWN0aW9uWzBdLmFwcGx5QWN0aW9uKHRoaXMpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnggPCAwIHx8XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi54ID49IHRoaXMuZ2FtZVdpZHRoICogdGhpcy5kaW1lbnNpb25zLndpZHRoIHx8XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi55IDwgMCB8fFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueSA+PSB0aGlzLmdhbWVIZWlnaHQgKiB0aGlzLmRpbWVuc2lvbnMuaGVpZ2h0XHJcbiAgICAgICkge1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJIaXQgRWRnZVwiKTtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gY3VycmVudFBvc2l0aW9uO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBbmRSZWRyYXdlcihjdHgpIHtcclxuICAgIHZhciBhY3Rpb25Qcm9iYWJpbGl0aWVzID0gdGhpcy5uZXVyYWxOZXR3b3JrLmZlZWRGb3J3YXJkKHRoaXMpO1xyXG4gICAgdGhpcy51cGRhdGUoYWN0aW9uUHJvYmFiaWxpdGllcyk7XHJcbiAgICB0aGlzLmRyYXdlcihjdHgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcclxuICBjb25zdHJ1Y3RvcihHQU1FX0hFSUdIVCwgR0FNRV9XSURUSCwgRElWSVNJT05fU0laRSwgU0hPV19HUkFQSCwgc3VjY2Vzc0NyaXRlcmlhKSB7XHJcbiAgICB0aGlzLmhlaWdodCA9IEdBTUVfSEVJR0hUO1xyXG4gICAgdGhpcy53aWR0aCA9IEdBTUVfV0lEVEg7XHJcbiAgICB0aGlzLmRpdmlzaW9uU2l6ZSA9IERJVklTSU9OX1NJWkU7XHJcbiAgICB0aGlzLnNob3dHcmFwaCA9IFNIT1dfR1JBUEg7XHJcbiAgICB0aGlzLnN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb24gPSBzdWNjZXNzQ3JpdGVyaWE7XHJcbiAgICB0aGlzLmdhbWVDcmVhdHVyZXMgPSBbXTtcclxuXHJcbiAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICB0aGlzLmNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImNhbnZhc1wiKTtcclxuICAgIHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIEdBTUVfV0lEVEggKiBESVZJU0lPTl9TSVpFKTtcclxuICAgIHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBHQU1FX0hFSUdIVCAqIERJVklTSU9OX1NJWkUpO1xyXG4gICAgdGhpcy5jYW52YXMuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJib3JkZXI6IDFweCBzb2xpZCBibGFjazsgYm94LXNpemluZzogYm9yZGVyLWJveFwiKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5jYW52YXMpO1xyXG4gICAgdGhpcy5jdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ3JlYXR1cmUoY3JlYXR1cmUpIHtcclxuICAgIHRoaXMuZ2FtZUNyZWF0dXJlcy5wdXNoKGNyZWF0dXJlKTtcclxuICB9XHJcblxyXG4gIGdldFN1cnZpdm9ycyhzdWNjZXNzQ3JpdGVyaWEpIHtcclxuICAgIHJldHVybiB0aGlzLmdhbWVDcmVhdHVyZXNcclxuICAgICAgLmZpbHRlcigoYykgPT4ge1xyXG4gICAgICAgIHJldHVybiBzdWNjZXNzQ3JpdGVyaWEuc29tZSgoY3JpdGVyaWEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IHhCb3R0b20gPSBjcml0ZXJpYS54ICsgY3JpdGVyaWEud2lkdGg7XHJcbiAgICAgICAgICBjb25zdCB5Qm90dG9tID0gY3JpdGVyaWEueSArIGNyaXRlcmlhLmhlaWdodDtcclxuICAgICAgICAgIHJldHVybiBjLnBvc2l0aW9uLnggPj0gY3JpdGVyaWEueCAmJiBjLnBvc2l0aW9uLnkgPj0gY3JpdGVyaWEueSAmJiBjLnBvc2l0aW9uLnggPD0geEJvdHRvbSAmJiBjLnBvc2l0aW9uLnkgPD0geUJvdHRvbTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSlcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICBpZiAoYS5maXRuZXNzID09PSAxKSB7XHJcbiAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGEuZml0bmVzcyAtIGIuZml0bmVzcztcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdHVyZUhhc01hZGVJdEhvbWUoY3JlYXR1cmUsIHN1Y2Nlc3NDcml0ZXJpYSkge1xyXG4gICAgcmV0dXJuIHN1Y2Nlc3NDcml0ZXJpYS5zb21lKChjcml0ZXJpYSkgPT4ge1xyXG4gICAgICBjb25zdCB4Qm90dG9tID0gY3JpdGVyaWEueCArIGNyaXRlcmlhLndpZHRoO1xyXG4gICAgICBjb25zdCB5Qm90dG9tID0gY3JpdGVyaWEueSArIGNyaXRlcmlhLmhlaWdodDtcclxuICAgICAgcmV0dXJuIChcclxuICAgICAgICBjcmVhdHVyZS5wb3NpdGlvbi54ID49IGNyaXRlcmlhLnggJiZcclxuICAgICAgICBjcmVhdHVyZS5wb3NpdGlvbi55ID49IGNyaXRlcmlhLnkgJiZcclxuICAgICAgICBjcmVhdHVyZS5wb3NpdGlvbi54IDw9IHhCb3R0b20gJiZcclxuICAgICAgICBjcmVhdHVyZS5wb3NpdGlvbi55IDw9IHlCb3R0b21cclxuICAgICAgKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZHJhd0dyaWQoKSB7XHJcbiAgICB0aGlzLmN0eC5saW5lV2lkdGggPSAwLjU7XHJcbiAgICAvLyBEbyBjb2x1bW5zXHJcbiAgICBmb3IgKGxldCBpbmRleCA9IHRoaXMuZGl2aXNpb25TaXplOyBpbmRleCA8IHRoaXMud2lkdGggKiB0aGlzLmRpdmlzaW9uU2l6ZTsgaW5kZXggKz0gdGhpcy5kaXZpc2lvblNpemUpIHtcclxuICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgIHRoaXMuY3R4Lm1vdmVUbyhpbmRleCwgMCk7XHJcbiAgICAgIHRoaXMuY3R4LmxpbmVUbyhpbmRleCwgdGhpcy5oZWlnaHQgKiB0aGlzLmRpdmlzaW9uU2l6ZSk7XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG4gICAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEbyBSb3dzXHJcbiAgICBmb3IgKGxldCBpbmRleCA9IHRoaXMuZGl2aXNpb25TaXplOyBpbmRleCA8IHRoaXMuaGVpZ2h0ICogdGhpcy5kaXZpc2lvblNpemU7IGluZGV4ICs9IHRoaXMuZGl2aXNpb25TaXplKSB7XHJcbiAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICB0aGlzLmN0eC5tb3ZlVG8oMCwgaW5kZXgpO1xyXG4gICAgICB0aGlzLmN0eC5saW5lVG8odGhpcy53aWR0aCAqIHRoaXMuZGl2aXNpb25TaXplLCBpbmRleCk7XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG4gICAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHVwZGF0ZShjdXJyZW50U3RlcENvdW50KSB7XHJcbiAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICB0aGlzLmN0eC5maWxsUmVjdCgwLCAwLCB0aGlzLndpZHRoICogdGhpcy5kaXZpc2lvblNpemUsIHRoaXMuaGVpZ2h0ICogdGhpcy5kaXZpc2lvblNpemUpO1xyXG4gICAgdGhpcy5nYW1lQ3JlYXR1cmVzLmZvckVhY2goKGNyZWF0dXJlKSA9PiB7XHJcbiAgICAgIGNyZWF0dXJlLnVwZGF0ZUFuZFJlZHJhd2VyKHRoaXMuY3R4KTtcclxuICAgICAgaWYgKGNyZWF0dXJlLmZpdG5lc3MgPT09IC0xICYmIHRoaXMuY3JlYXR1cmVIYXNNYWRlSXRIb21lKGNyZWF0dXJlLCB0aGlzLnN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb24uc3VjY2Vzc0NyaXRlcmlhKSkge1xyXG4gICAgICAgIGNyZWF0dXJlLnNldEZpdG5lc3MoY3VycmVudFN0ZXBDb3VudCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh0aGlzLnNob3dHcmFwaCkge1xyXG4gICAgICB0aGlzLmRyYXdHcmlkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zdWNjZXNzQ3JpdGVyaWFWaXN1YWxpemF0aW9uLmRyYXdlcih0aGlzLmN0eCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBjaGVja0JpdChudW1iZXIsIGJpdFRvQ2hlY2spIHtcclxuICB2YXIgbWFzayA9ICgxIDw8IGJpdFRvQ2hlY2spID4+PiAwO1xyXG4gIHZhciByZXN1bHQgPSAobnVtYmVyICYgbWFzaykgPj4+IDA7XHJcbiAgcmV0dXJuIHJlc3VsdCAhPT0gMDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNsaWNlKG51bWJlciwgc3RhcnQsIGVuZCkge1xyXG4gIHZhciBtYXNrID0gTWF0aC5wb3coMiwgZW5kIC0gc3RhcnQgKyAxKSAtIDE7XHJcbiAgbWFzayA9IG1hc2sgPDwgc3RhcnQ7XHJcbiAgdmFyIHJlc3VsdCA9IG51bWJlciAmIG1hc2s7XHJcbiAgcmV0dXJuIHJlc3VsdCA+PiBzdGFydDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZsaXBCaXQobnVtYmVyLCBiaXRUb0ZsaXApIHtcclxuICBpZiAoY2hlY2tCaXQobnVtYmVyLCBiaXRUb0ZsaXApKSB7XHJcbiAgICAvLyBiaXQgaXMgb25cclxuICAgIHZhciBtYXNrID0gMSA8PCBiaXRUb0ZsaXA7XHJcbiAgICAvLyBpbnZlcnQgbWFzayB0aGVuIGFuZFxyXG4gICAgbWFzayA9IH5tYXNrO1xyXG4gICAgcmV0dXJuIChudW1iZXIgJiBtYXNrKSA+Pj4gMDtcclxuICB9XHJcblxyXG4gIC8vIGJpdCBpcyBvZmZcclxuICB2YXIgbWFzayA9IDEgPDwgYml0VG9GbGlwO1xyXG4gIHJldHVybiAobnVtYmVyIHwgbWFzaykgPj4+IDA7XHJcbn1cclxuIiwiaW1wb3J0IHsgZmxpcEJpdCB9IGZyb20gXCIuL2JpdC1vcGVyYXRpb25zXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHZW5vbWUge1xyXG4gIGNvbnN0cnVjdG9yKHNpemUsIGdlbmVyYXRlUmFuZG9tVmFsdWVzID0gdHJ1ZSkge1xyXG4gICAgaWYgKHNpemUgJSAyICE9PSAwKSB7XHJcbiAgICAgIHRocm93IFwiR2Vub21lIHNpemUgbXVzdCBiZSBhbiBldmVuIG51bWJlci5cIjtcclxuICAgIH1cclxuICAgIHRoaXMuc2l6ZSA9IHNpemU7XHJcbiAgICB0aGlzLmNocm9tb3NvbWVzID0gbmV3IFVpbnQzMkFycmF5KHNpemUpO1xyXG4gICAgaWYgKGdlbmVyYXRlUmFuZG9tVmFsdWVzKSB7XHJcbiAgICAgIHdpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHRoaXMuY2hyb21vc29tZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGNyZWF0ZU5ld0dlbm9tZUZyb21QYXJlbnRzKGdlbm9tZU9uZSwgZ2Vub21lVHdvLCBtdXRhdGlvblJhdGUpIHtcclxuICAgIHZhciB0YWtlRnJvbVBhcmVudE9uZUZpcnN0ID0gTWF0aC5yYW5kb20oKSA+IDAuNTtcclxuICAgIHZhciBzaXplID0gZ2Vub21lT25lLnNpemU7XHJcbiAgICB2YXIgbmV3R2Vub21lID0gbmV3IEdlbm9tZShzaXplLCBmYWxzZSk7XHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgc2l6ZTsgaW5kZXgrKykge1xyXG4gICAgICBpZiAodGFrZUZyb21QYXJlbnRPbmVGaXJzdCkge1xyXG4gICAgICAgIG5ld0dlbm9tZS5jaHJvbW9zb21lc1tpbmRleF0gPSBnZW5vbWVPbmUuY2hyb21vc29tZXNbaW5kZXhdO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG5ld0dlbm9tZS5jaHJvbW9zb21lc1tpbmRleF0gPSBnZW5vbWVUd28uY2hyb21vc29tZXNbaW5kZXhdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgbXV0YXRpb25TaG91bGRPY2N1cmUgPSBNYXRoLnJhbmRvbSgpIDwgbXV0YXRpb25SYXRlO1xyXG4gICAgICBpZiAobXV0YXRpb25TaG91bGRPY2N1cmUpIHtcclxuICAgICAgICB2YXIgb3JpZ2luYWxDaHJvbW9zb21lID0gbmV3R2Vub21lLmNocm9tb3NvbWVzW2luZGV4XTtcclxuICAgICAgICB2YXIgYml0VG9GbGlwID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMzIpICsgMTtcclxuICAgICAgICB2YXIgbXV0YXRlZENocm9tb3NvbWUgPSBmbGlwQml0KG9yaWdpbmFsQ2hyb21vc29tZSwgYml0VG9GbGlwKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIGBNdXRhdGlvbiBvY2N1cmVkIG9uIGJpdCAke2JpdFRvRmxpcH0sIGNoYW5nZSBmcm9tICR7KG9yaWdpbmFsQ2hyb21vc29tZSA+Pj4gMCkudG9TdHJpbmcoMil9IHRvICR7KFxyXG4gICAgICAgICAgICBtdXRhdGVkQ2hyb21vc29tZSA+Pj4gMFxyXG4gICAgICAgICAgKS50b1N0cmluZygyKX0uYFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbmV3R2Vub21lLmNocm9tb3NvbWVzW2luZGV4XSA9IG11dGF0ZWRDaHJvbW9zb21lO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0YWtlRnJvbVBhcmVudE9uZUZpcnN0ID0gIXRha2VGcm9tUGFyZW50T25lRmlyc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ld0dlbm9tZTtcclxuICB9XHJcblxyXG4gIHRvU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuY2hyb21vc29tZXMuam9pbihcIjpcIik7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE5ldXJvbiB7XHJcbiAgY29uc3RydWN0b3IodHlwZSwgZ2FtZSkge1xyXG4gICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgICB0aGlzLmNvbm5lY3Rpb25zID0gW107XHJcbiAgICB0aGlzLmxhc3RWYWx1ZSA9IDA7XHJcbiAgfVxyXG5cclxuICBzY2FsZVZhbHVlKHZhbHVlLCB4TWluLCB4TWF4LCB5TWluLCB5TWF4KSB7XHJcbiAgICB2YXIgcGVyY2VudCA9ICh2YWx1ZSAtIHlNaW4pIC8gKHlNYXggLSB5TWluKTtcclxuICAgIHJldHVybiBwZXJjZW50ICogKHhNYXggLSB4TWluKSArIHhNaW47XHJcbiAgfVxyXG5cclxuICBhZGRDb25uZWN0aW9uKGNvbm5lY3Rpb24pIHtcclxuICAgIHRoaXMuY29ubmVjdGlvbnMucHVzaChjb25uZWN0aW9uKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxhc3RWYWx1ZShsYXN0VmFsdWUpIHtcclxuICAgIHRoaXMubGFzdFZhbHVlID0gbGFzdFZhbHVlO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmFsdWUoY3JlYXR1cmUpIHtcclxuICAgIHJldHVybiB0aGlzLmxhc3RWYWx1ZTtcclxuICB9XHJcblxyXG4gIGFwcGx5QWN0aW9uKGNyZWF0dXJlKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiBgJHt0aGlzLnR5cGV9YDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9FYXN0IGV4dGVuZHMgTmV1cm9uIHtcclxuICBjb25zdHJ1Y3RvcihnYW1lKSB7XHJcbiAgICBzdXBlcihcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb0Vhc3RcIiwgZ2FtZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWYWx1ZShjcmVhdHVyZSkge1xyXG4gICAgdmFyIHNjYWxlZEdhbWVXaWR0aCA9IHRoaXMuZ2FtZS53aWR0aCAqIHRoaXMuZ2FtZS5kaXZpc2lvblNpemU7XHJcbiAgICB2YXIgc2NhbGVkSW5wdXQgPSB0aGlzLnNjYWxlVmFsdWUoY3JlYXR1cmUucG9zaXRpb24ueCwgMCwgMSwgMCwgc2NhbGVkR2FtZVdpZHRoKTtcclxuICAgIHJldHVybiBzY2FsZWRJbnB1dDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9XZXN0IGV4dGVuZHMgTmV1cm9uIHtcclxuICBjb25zdHJ1Y3RvcihnYW1lKSB7XHJcbiAgICBzdXBlcihcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb1dlc3RcIiwgZ2FtZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWYWx1ZShjcmVhdHVyZSkge1xyXG4gICAgdmFyIHNjYWxlZEdhbWVXaWR0aCA9IHRoaXMuZ2FtZS53aWR0aCAqIHRoaXMuZ2FtZS5kaXZpc2lvblNpemU7XHJcbiAgICB2YXIgaW52ZXJ0ZWRYID0gc2NhbGVkR2FtZVdpZHRoIC0gY3JlYXR1cmUucG9zaXRpb24ueDtcclxuICAgIHZhciBzY2FsZWRJbnB1dCA9IHRoaXMuc2NhbGVWYWx1ZShpbnZlcnRlZFgsIDAsIDEsIDAsIHNjYWxlZEdhbWVXaWR0aCk7XHJcbiAgICByZXR1cm4gc2NhbGVkSW5wdXQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBOZXVyb24gZnJvbSBcIi4uL25ldXJvblwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvU291dGggZXh0ZW5kcyBOZXVyb24ge1xyXG4gIGNvbnN0cnVjdG9yKGdhbWUpIHtcclxuICAgIHN1cGVyKFwiU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvU291dGhcIiwgZ2FtZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWYWx1ZShjcmVhdHVyZSkge1xyXG4gICAgdmFyIHNjYWxlZEdhbWVIZWlnaHQgPSB0aGlzLmdhbWUuaGVpZ2h0ICogdGhpcy5nYW1lLmRpdmlzaW9uU2l6ZTtcclxuICAgIHZhciBzY2FsZWRJbnB1dCA9IHRoaXMuc2NhbGVWYWx1ZShjcmVhdHVyZS5wb3NpdGlvbi55LCAwLCAxLCAwLCBzY2FsZWRHYW1lSGVpZ2h0KTtcclxuICAgIHJldHVybiBzY2FsZWRJbnB1dDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9Ob3J0aCBleHRlbmRzIE5ldXJvbiB7XHJcbiAgY29uc3RydWN0b3IoZ2FtZSkge1xyXG4gICAgc3VwZXIoXCJTZW5zaXRpdml0eVRvUHJveGltaXR5VG9Ob3J0aFwiLCBnYW1lKTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBpZiBjcmVhdHVyZS55ID0gMCByZXR1cm4gMVxyXG4gICAgaWYgY3JlYXR1cmUueSA9IDEyOCByZXR1cm4gMFxyXG4gICovXHJcbiAgZ2V0VmFsdWUoY3JlYXR1cmUpIHtcclxuICAgIHZhciBzY2FsZWRHYW1lSGVpZ2h0ID0gdGhpcy5nYW1lLmhlaWdodCAqIHRoaXMuZ2FtZS5kaXZpc2lvblNpemU7XHJcbiAgICB2YXIgaW52ZXJ0ZWRZID0gc2NhbGVkR2FtZUhlaWdodCAtIGNyZWF0dXJlLnBvc2l0aW9uLnk7XHJcbiAgICB2YXIgc2NhbGVkSW5wdXQgPSB0aGlzLnNjYWxlVmFsdWUoaW52ZXJ0ZWRZLCAwLCAxLCAwLCBzY2FsZWRHYW1lSGVpZ2h0KTtcclxuICAgIHJldHVybiBzY2FsZWRJbnB1dDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29ubmVjdGlvbiB7XHJcbiAgY29uc3RydWN0b3Ioc291cmNlLCBzaW5rLCB3ZWlnaHQpIHtcclxuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xyXG4gICAgdGhpcy5zaW5rID0gc2luaztcclxuICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xyXG4gIH1cclxuXHJcbiAgdG9TdHJpbmcoKSB7XHJcbiAgICByZXR1cm4gYCR7dGhpcy5zb3VyY2V9OiR7dGhpcy5zaW5rfToke3RoaXMud2VpZ2h0fWA7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBOZXVyb24gZnJvbSBcIi4uL25ldXJvblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdvTm9ydGggZXh0ZW5kcyBOZXVyb24ge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoXCJHb05vcnRoXCIpO1xyXG4gIH1cclxuXHJcbiAgYXBwbHlBY3Rpb24oY3JlYXR1cmUpIHtcclxuICAgIGNyZWF0dXJlLnBvc2l0aW9uLnkgLT0gY3JlYXR1cmUuc3BlZWQgKiBjcmVhdHVyZS5kaW1lbnNpb25zLndpZHRoO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTmV1cm9uIGZyb20gXCIuLi9uZXVyb25cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHb05vcnRoRWFzdCBleHRlbmRzIE5ldXJvbiB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcihcIkdvTm9ydGhFYXN0XCIpO1xyXG4gIH1cclxuXHJcbiAgYXBwbHlBY3Rpb24oY3JlYXR1cmUpIHtcclxuICAgIGNyZWF0dXJlLnBvc2l0aW9uLnkgLT0gY3JlYXR1cmUuc3BlZWQgKiBjcmVhdHVyZS5kaW1lbnNpb25zLndpZHRoO1xyXG4gICAgY3JlYXR1cmUucG9zaXRpb24ueCArPSBjcmVhdHVyZS5zcGVlZCAqIGNyZWF0dXJlLmRpbWVuc2lvbnMud2lkdGg7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBOZXVyb24gZnJvbSBcIi4uL25ldXJvblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdvRWFzdCBleHRlbmRzIE5ldXJvbiB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcihcIkdvRWFzdFwiKTtcclxuICB9XHJcblxyXG4gIGFwcGx5QWN0aW9uKGNyZWF0dXJlKSB7XHJcbiAgICBjcmVhdHVyZS5wb3NpdGlvbi54ICs9IGNyZWF0dXJlLnNwZWVkICogY3JlYXR1cmUuZGltZW5zaW9ucy53aWR0aDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgR29Tb3V0aEVhc3QgZXh0ZW5kcyBOZXVyb24ge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoXCJHb1NvdXRoRWFzdFwiKTtcclxuICB9XHJcblxyXG4gIGFwcGx5QWN0aW9uKGNyZWF0dXJlKSB7XHJcbiAgICBjcmVhdHVyZS5wb3NpdGlvbi54ICs9IGNyZWF0dXJlLnNwZWVkICogY3JlYXR1cmUuZGltZW5zaW9ucy53aWR0aDtcclxuICAgIGNyZWF0dXJlLnBvc2l0aW9uLnkgKz0gY3JlYXR1cmUuc3BlZWQgKiBjcmVhdHVyZS5kaW1lbnNpb25zLndpZHRoO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTmV1cm9uIGZyb20gXCIuLi9uZXVyb25cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHb1NvdXRoIGV4dGVuZHMgTmV1cm9uIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKFwiR29Tb3V0aFwiKTtcclxuICB9XHJcblxyXG4gIGFwcGx5QWN0aW9uKGNyZWF0dXJlKSB7XHJcbiAgICBjcmVhdHVyZS5wb3NpdGlvbi55ICs9IGNyZWF0dXJlLnNwZWVkICogY3JlYXR1cmUuZGltZW5zaW9ucy53aWR0aDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgR29Tb3V0aFdlc3QgZXh0ZW5kcyBOZXVyb24ge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoXCJHb1NvdXRoV2VzdFwiKTtcclxuICB9XHJcblxyXG4gIGFwcGx5QWN0aW9uKGNyZWF0dXJlKSB7XHJcbiAgICBjcmVhdHVyZS5wb3NpdGlvbi55ICs9IGNyZWF0dXJlLnNwZWVkICogY3JlYXR1cmUuZGltZW5zaW9ucy53aWR0aDtcclxuICAgIGNyZWF0dXJlLnBvc2l0aW9uLnggLT0gY3JlYXR1cmUuc3BlZWQgKiBjcmVhdHVyZS5kaW1lbnNpb25zLndpZHRoO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTmV1cm9uIGZyb20gXCIuLi9uZXVyb25cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHb1dlc3QgZXh0ZW5kcyBOZXVyb24ge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoXCJHb1dlc3RcIik7XHJcbiAgfVxyXG5cclxuICBhcHBseUFjdGlvbihjcmVhdHVyZSkge1xyXG4gICAgY3JlYXR1cmUucG9zaXRpb24ueCAtPSBjcmVhdHVyZS5zcGVlZCAqIGNyZWF0dXJlLmRpbWVuc2lvbnMud2lkdGg7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBOZXVyb24gZnJvbSBcIi4uL25ldXJvblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdvTm9ydGhXZXN0IGV4dGVuZHMgTmV1cm9uIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKFwiR29Ob3J0aFdlc3RcIik7XHJcbiAgfVxyXG5cclxuICBhcHBseUFjdGlvbihjcmVhdHVyZSkge1xyXG4gICAgY3JlYXR1cmUucG9zaXRpb24ueSAtPSBjcmVhdHVyZS5zcGVlZCAqIGNyZWF0dXJlLmRpbWVuc2lvbnMud2lkdGg7XHJcbiAgICBjcmVhdHVyZS5wb3NpdGlvbi54IC09IGNyZWF0dXJlLnNwZWVkICogY3JlYXR1cmUuZGltZW5zaW9ucy53aWR0aDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi4vbmV1cm9uXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRG9Ob3RoaW5nIGV4dGVuZHMgTmV1cm9uIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKFwiRG9Ob3RoaW5nXCIpO1xyXG4gIH1cclxuXHJcbiAgYXBwbHlBY3Rpb24oY3JlYXR1cmUpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgY2hlY2tCaXQsIHNsaWNlIH0gZnJvbSBcIi4uL2JpdC1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCBDb25uZWN0aW9uIGZyb20gXCIuL2Nvbm5lY3Rpb25cIjtcclxuaW1wb3J0IE5ldXJvbiBmcm9tIFwiLi9uZXVyb25cIjtcclxuaW1wb3J0IHsgR29Ob3J0aCB9IGZyb20gXCIuL291dHB1dHMvR29Ob3J0aFwiO1xyXG5pbXBvcnQgeyBHb05vcnRoRWFzdCB9IGZyb20gXCIuL291dHB1dHMvR29Ob3J0aEVhc3RcIjtcclxuaW1wb3J0IHsgR29FYXN0IH0gZnJvbSBcIi4vb3V0cHV0cy9Hb0Vhc3RcIjtcclxuaW1wb3J0IHsgR29Tb3V0aEVhc3QgfSBmcm9tIFwiLi9vdXRwdXRzL0dvU291dGhFYXN0XCI7XHJcbmltcG9ydCB7IEdvU291dGggfSBmcm9tIFwiLi9vdXRwdXRzL0dvU291dGhcIjtcclxuaW1wb3J0IHsgR29Tb3V0aFdlc3QgfSBmcm9tIFwiLi9vdXRwdXRzL0dvU291dGhXZXN0XCI7XHJcbmltcG9ydCB7IEdvV2VzdCB9IGZyb20gXCIuL291dHB1dHMvR29XZXN0XCI7XHJcbmltcG9ydCB7IEdvTm9ydGhXZXN0IH0gZnJvbSBcIi4vb3V0cHV0cy9Hb05vcnRoV2VzdFwiO1xyXG5pbXBvcnQgeyBEb05vdGhpbmcgfSBmcm9tIFwiLi9vdXRwdXRzL0RvTm90aGluZ1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTmV1cmFsTmV0d29yayB7XHJcbiAgY29uc3RydWN0b3IobnVtYmVyT2ZIaWRkZW5OZXVyb25zLCBnZW5vbWUsIHNlbnNpdGl2aXR5TmV1cm9uRmFjdG9yeSkge1xyXG4gICAgdGhpcy5nZW5vbWUgPSBnZW5vbWU7XHJcbiAgICB0aGlzLmhpZGRlbk5ldXJvbnMgPSBuZXcgQXJyYXkobnVtYmVyT2ZIaWRkZW5OZXVyb25zKTtcclxuXHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5oaWRkZW5OZXVyb25zLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICB0aGlzLmhpZGRlbk5ldXJvbnNbaW5kZXhdID0gbmV3IE5ldXJvbihgSGlkZGVuIExheWVyICR7aW5kZXh9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5pbnB1dE5ldXJvbnMgPSBbXHJcbiAgICAgIHNlbnNpdGl2aXR5TmV1cm9uRmFjdG9yeShcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb0Vhc3RcIiksXHJcbiAgICAgIHNlbnNpdGl2aXR5TmV1cm9uRmFjdG9yeShcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb05vcnRoXCIpLFxyXG4gICAgICBzZW5zaXRpdml0eU5ldXJvbkZhY3RvcnkoXCJTZW5zaXRpdml0eVRvUHJveGltaXR5VG9Tb3V0aFwiKSxcclxuICAgICAgc2Vuc2l0aXZpdHlOZXVyb25GYWN0b3J5KFwiU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvV2VzdFwiKSxcclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5vdXRwdXROZXVyb25zID0gW1xyXG4gICAgICBuZXcgRG9Ob3RoaW5nKCksXHJcbiAgICAgIG5ldyBHb05vcnRoKCksXHJcbiAgICAgIG5ldyBHb05vcnRoRWFzdCgpLFxyXG4gICAgICBuZXcgR29FYXN0KCksXHJcbiAgICAgIG5ldyBHb1NvdXRoRWFzdCgpLFxyXG4gICAgICBuZXcgR29Tb3V0aCgpLFxyXG4gICAgICBuZXcgR29Tb3V0aFdlc3QoKSxcclxuICAgICAgbmV3IEdvV2VzdCgpLFxyXG4gICAgICBuZXcgR29Ob3J0aFdlc3QoKSxcclxuICAgIF07XHJcblxyXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuZ2Vub21lLnNpemU7IGluZGV4KyspIHtcclxuICAgICAgdmFyIGNocm9tb3NvbWUgPSB0aGlzLmdlbm9tZS5jaHJvbW9zb21lc1tpbmRleF07XHJcbiAgICAgIHRoaXMuYWRkQ29ubmVjdGlvbihjaHJvbW9zb21lKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNjYWxlV2VpZ2h0KHdlaWdodCwgeE1pbiwgeE1heCwgeU1pbiwgeU1heCkge1xyXG4gICAgdmFyIHBlcmNlbnQgPSAod2VpZ2h0IC0geU1pbikgLyAoeU1heCAtIHlNaW4pO1xyXG4gICAgcmV0dXJuIHBlcmNlbnQgKiAoeE1heCAtIHhNaW4pICsgeE1pbjtcclxuICB9XHJcblxyXG4gIC8vIGZpcnN0IGJpdCBpcyBzb3VyY2UgdHlwZSAoaS5lIDAgPSBzZW5zb3IgbmV1cm9uLCBvciAxIGhpZGRlbiBuZXVyb24pXHJcbiAgLy8gbmV4dCA1IGJpdHMgZGV0ZXJtaW5lIHdoaWNoIGluc3RhbmNlIG9mIHRoYXQgc291cmNlIHR5cGUgd2UgaGF2ZVxyXG4gIC8vIG5leHQgYml0IGlzIHRoZSBzaW5rIHR5cGUgKGkuZSBhbiBpbnRlcm5hbCBuZXVyb24gb3IgYW4gYWN0aW9uL291dHB1dCBuZXVyb24pXHJcbiAgLy8gbmV4dCAyMCBiaXRzIGlzIHRoZSB3ZWlnaHQgb2YgdGhlIGNvbm5lY3Rpb25cclxuXHJcbiAgLy8gICAgICAzMXwgMzAtMjYgfCAyNXwgMjQtMjAgfDE5LS0tLS0tLS0tLS0tLS0tLS0wXHJcbiAgLy8gICAgICAgMXwgMDExMTAgfCAwIHwgMTEwMDAgfDEwMDEwMTExMDAxMDExMDAwMTAxXHJcbiAgLy9FLmcuICAgMHwgMDAwMTEgfCAwIHwgMDExMDAgfDExMDAxMTAwMTEwMDExMDAxMTAwXHJcbiAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMDAwMDAwMDAwMDAwMDAwMDAwXHJcbiAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDExMTExMTExMTExMTExMTExMTExID0gMCB0byAxMDQ4NTc1XHJcbiAgYWRkQ29ubmVjdGlvbihjaHJvbW9zb21lKSB7XHJcbiAgICB2YXIgc291cmNlSXNBbklucHV0TmV1cm9uID0gY2hlY2tCaXQoY2hyb21vc29tZSwgMzEpOyAvLyAwIGJhc2VkIGluZGV4IG9uIHRoZSBiaXRzLCBpLmUuIDAgaXMgZnVydGhlc3QgcmlnaHQgKGxlYXN0IHNpZ25pZmljYW50IGJpdClcclxuICAgIHZhciBnZXRTb3VyY2VJbnN0YW5jZSA9IHNsaWNlKGNocm9tb3NvbWUsIDI2LCAzMCkgJSAoc291cmNlSXNBbklucHV0TmV1cm9uID8gdGhpcy5pbnB1dE5ldXJvbnMubGVuZ3RoIDogdGhpcy5oaWRkZW5OZXVyb25zLmxlbmd0aCk7XHJcbiAgICB2YXIgc2lua0lzQW5PdXRwdXROZXVyb24gPSBjaGVja0JpdChjaHJvbW9zb21lLCAyNSk7XHJcbiAgICB2YXIgZ2V0T3V0cHV0SW5zdGFuY2UgPSBzbGljZShjaHJvbW9zb21lLCAyMCwgMjQpICUgKHNpbmtJc0FuT3V0cHV0TmV1cm9uID8gdGhpcy5vdXRwdXROZXVyb25zLmxlbmd0aCA6IHRoaXMuaGlkZGVuTmV1cm9ucy5sZW5ndGgpO1xyXG4gICAgdmFyIHdlaWdodCA9IHRoaXMuc2NhbGVXZWlnaHQoc2xpY2UoY2hyb21vc29tZSwgMCwgMTkpLCAtNCwgNCwgMCwgMTA0ODU3NSk7XHJcblxyXG4gICAgdmFyIHNvdXJjZTtcclxuICAgIHZhciBzaW5rO1xyXG5cclxuICAgIGlmIChzb3VyY2VJc0FuSW5wdXROZXVyb24pIHtcclxuICAgICAgLy8gZ2V0IHRoZSBzZW5zb3IgdHlwZVxyXG4gICAgICBzb3VyY2UgPSB0aGlzLmlucHV0TmV1cm9uc1tnZXRTb3VyY2VJbnN0YW5jZV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyB0aGlzIGlzIGEgaGlkZGVuIGxheWVyIG5ldXJvblxyXG4gICAgICBzb3VyY2UgPSB0aGlzLmhpZGRlbk5ldXJvbnNbZ2V0U291cmNlSW5zdGFuY2VdO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzaW5rSXNBbk91dHB1dE5ldXJvbikge1xyXG4gICAgICAvLyBnZXQgdGhlIGFjdGlvbiB0eXBlXHJcbiAgICAgIHNpbmsgPSB0aGlzLm91dHB1dE5ldXJvbnNbZ2V0T3V0cHV0SW5zdGFuY2VdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gdGhpcyBpcyBhIGhpZGRlbiBsYXllciBuZXVyb25cclxuICAgICAgc2luayA9IHRoaXMuaGlkZGVuTmV1cm9uc1tnZXRPdXRwdXRJbnN0YW5jZV07XHJcbiAgICB9XHJcblxyXG4gICAgc2luay5hZGRDb25uZWN0aW9uKG5ldyBDb25uZWN0aW9uKHNvdXJjZSwgc2luaywgd2VpZ2h0KSk7XHJcbiAgfVxyXG5cclxuICBmZWVkRm9yd2FyZChjcmVhdHVyZSkge1xyXG4gICAgLy8gT25seSByZXR1cm4gb3V0cHV0IG5ldXJvbnMgd2l0aCBhIHBvc2l0aXZlIFwicHJvYmFiaWxpdHlcIlxyXG4gICAgcmV0dXJuIHRoaXMub3V0cHV0TmV1cm9ucy5maWx0ZXIoKG4pID0+IHtcclxuICAgICAgdmFyIG91dHB1dEZvck4gPSB0aGlzLmZlZWRGb3J3YXJkUGVyKG4sIGNyZWF0dXJlKTtcclxuICAgICAgbi51cGRhdGVMYXN0VmFsdWUob3V0cHV0Rm9yTik7XHJcbiAgICAgIHJldHVybiBvdXRwdXRGb3JOID4gMDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZmVlZEZvcndhcmRQZXIobmV1cm9uLCBjcmVhdHVyZSkge1xyXG4gICAgdmFyIGRlcHRoID0gMDtcclxuXHJcbiAgICBsZXQgZ2V0SW5wdXQgPSAoY29ubmVjdGlvbiwgc2Vlbk5vZGVzKSA9PiB7XHJcbiAgICAgIGRlcHRoKys7XHJcbiAgICAgIGlmIChkZXB0aCA+IDE1KSB7XHJcbiAgICAgICAgLy9kZWJ1Z2dlcjtcclxuICAgICAgfVxyXG4gICAgICAvLyB0aGlzIGNvbm5lY3Rpb24gaGFzIGEgc291cmNlIGFuZCBhIHdlaWdodCwgbmVlZCB0byBnZXQgdGhlIHNvdXJjZSBpbnB1dCB2YWx1ZSAqIHdlaWdodCBhbmQgcmV0dXJuIHRoYXRcclxuICAgICAgdmFyIHNpbmsgPSBjb25uZWN0aW9uLnNpbms7XHJcbiAgICAgIHZhciBzb3VyY2UgPSBjb25uZWN0aW9uLnNvdXJjZTtcclxuICAgICAgdmFyIHdlaWdodCA9IGNvbm5lY3Rpb24ud2VpZ2h0O1xyXG4gICAgICBzZWVuTm9kZXMuc2V0KHNpbmssIHNpbmsuZ2V0VmFsdWUoY3JlYXR1cmUpKTtcclxuXHJcbiAgICAgIGlmIChzZWVuTm9kZXMuaGFzKHNvdXJjZSkpIHtcclxuICAgICAgICByZXR1cm4gc2Vlbk5vZGVzLmdldChzb3VyY2UpO1xyXG4gICAgICB9IGVsc2UgaWYgKHNvdXJjZS5jb25uZWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAvLyB3ZSdyZSBhdCB0aGUgdG9wIG9mIHRoZSB0cmVlIHNvIHJldHVybiB0aGUgdmFsdWUgb2YgdGhlIGlucHV0ICogd2VpZ2h0XHJcbiAgICAgICAgdmFyIGlucHV0ID0gc291cmNlLmdldFZhbHVlKGNyZWF0dXJlKTtcclxuICAgICAgICByZXR1cm4gaW5wdXQgKiB3ZWlnaHQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gd2Ugc3RpbGwgaGF2ZSBtb3JlIGNvbm5lY3Rpb25zIHRvIGdldFxyXG4gICAgICAgIHZhciBzdW1PZldlaWdodGVkSW5wdXRzID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgc291cmNlLmNvbm5lY3Rpb25zLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHNvdXJjZS5jb25uZWN0aW9uc1tpbmRleF07XHJcbiAgICAgICAgICBzdW1PZldlaWdodGVkSW5wdXRzICs9IGdldElucHV0KGNvbm5lY3Rpb24sIHNlZW5Ob2Rlcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gTWF0aC50YW5oKHN1bU9mV2VpZ2h0ZWRJbnB1dHMpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzdW1PZldlaWdodGVkSW5wdXRzID0gMDtcclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBuZXVyb24uY29ubmVjdGlvbnMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgIGNvbnN0IHNlZW5Ob2RlcyA9IG5ldyBNYXAoKTtcclxuICAgICAgY29uc3QgY29ubmVjdGlvbiA9IG5ldXJvbi5jb25uZWN0aW9uc1tpbmRleF07XHJcbiAgICAgIHN1bU9mV2VpZ2h0ZWRJbnB1dHMgKz0gZ2V0SW5wdXQoY29ubmVjdGlvbiwgc2Vlbk5vZGVzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBNYXRoLnRhbmgoc3VtT2ZXZWlnaHRlZElucHV0cyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDcmVhdHVyZSBmcm9tIFwiLi9jcmVhdHVyZS5qc1wiO1xyXG5pbXBvcnQgR2FtZSBmcm9tIFwiLi9nYW1lLmpzXCI7XHJcbmltcG9ydCBHZW5vbWUgZnJvbSBcIi4vZ2Vub21lLmpzXCI7XHJcbmltcG9ydCBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9FYXN0IGZyb20gXCIuL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9FYXN0XCI7XHJcbmltcG9ydCBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9XZXN0IGZyb20gXCIuL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9XZXN0XCI7XHJcbmltcG9ydCBTZW5zaXRpdml0eVRvUHJveGltaXR5VG9Tb3V0aCBmcm9tIFwiLi9ubi9pbnB1dHMvU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvU291dGhcIjtcclxuaW1wb3J0IFNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb05vcnRoIGZyb20gXCIuL25uL2lucHV0cy9TZW5zaXRpdml0eVRvUHJveGltaXR5VG9Ob3J0aFwiO1xyXG5pbXBvcnQgTmV1cmFsTmV0d29yayBmcm9tIFwiLi9ubi9uZXVyYWwtbmV0d29yay5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2ltdWxhdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBzaXplT2ZQb3B1bGF0aW9uLFxyXG4gICAgbnVtYmVyT2ZHZW5lcmF0aW9uc1RvUnVuLFxyXG4gICAgbW92ZXNQZXJHZW5lcmF0aW9uLFxyXG4gICAgZnJhbWVzUGVyU2Vjb25kLFxyXG4gICAgc2l6ZU9mR2Vub21lLFxyXG4gICAgbnVtYmVyT2ZOZXVyb25zSW5IaWRkZW5MYXllcixcclxuICAgIG11dGF0aW9uUmF0ZSxcclxuICAgIHN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb25cclxuICApIHtcclxuICAgIHRoaXMuc2l6ZU9mUG9wdWxhdGlvbiA9IHNpemVPZlBvcHVsYXRpb247XHJcbiAgICB0aGlzLm51bWJlck9mR2VuZXJhdGlvbnNUb1J1biA9IG51bWJlck9mR2VuZXJhdGlvbnNUb1J1bjtcclxuICAgIHRoaXMubW92ZXNQZXJHZW5lcmF0aW9uID0gbW92ZXNQZXJHZW5lcmF0aW9uO1xyXG4gICAgdGhpcy5mcmFtZXNQZXJTZWNvbmQgPSBmcmFtZXNQZXJTZWNvbmQ7XHJcbiAgICB0aGlzLnNpemVPZkdlbm9tZSA9IHNpemVPZkdlbm9tZTtcclxuICAgIHRoaXMubnVtYmVyT2ZOZXVyb25zSW5IaWRkZW5MYXllciA9IG51bWJlck9mTmV1cm9uc0luSGlkZGVuTGF5ZXI7XHJcbiAgICB0aGlzLm11dGF0aW9uUmF0ZSA9IG11dGF0aW9uUmF0ZTtcclxuICAgIHRoaXMuc3VjY2Vzc0NyaXRlcmlhVmlzdWFsaXphdGlvbiA9IHN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb247XHJcblxyXG4gICAgdGhpcy5fc2Vuc2l0aXZpdHlOZXVyb25GYWN0b3J5ID0gKGdhbWUpID0+ICh0eXBlKSA9PiB7XHJcbiAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgIGNhc2UgXCJTZW5zaXRpdml0eVRvUHJveGltaXR5VG9FYXN0XCI6XHJcbiAgICAgICAgICByZXR1cm4gbmV3IFNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb0Vhc3QoZ2FtZSk7XHJcbiAgICAgICAgY2FzZSBcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb1dlc3RcIjpcclxuICAgICAgICAgIHJldHVybiBuZXcgU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvV2VzdChnYW1lKTtcclxuICAgICAgICBjYXNlIFwiU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvU291dGhcIjpcclxuICAgICAgICAgIHJldHVybiBuZXcgU2Vuc2l0aXZpdHlUb1Byb3hpbWl0eVRvU291dGgoZ2FtZSk7XHJcbiAgICAgICAgY2FzZSBcIlNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb05vcnRoXCI6XHJcbiAgICAgICAgICByZXR1cm4gbmV3IFNlbnNpdGl2aXR5VG9Qcm94aW1pdHlUb05vcnRoKGdhbWUpO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmN1cnJlbnRTdGVwQ291bnQgPSAwO1xyXG4gICAgdGhpcy5jdXJyZW50R2VuZXJhdGlvbkNvdW50ID0gMDtcclxuICAgIHRoaXMuZ2VuZXJhdGlvbkNvdW50TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGlvbkNvdW50TGFiZWwpO1xyXG4gICAgdGhpcy5zdGVwQ291bnRMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5zdGVwQ291bnRMYWJlbCk7XHJcbiAgfVxyXG5cclxuICBfcmFuZG9tTnVtYmVyQmV0d2VlbihtaW4sIG1heCkge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgMSk7XHJcbiAgfVxyXG5cclxuICBfcm91bmRUb05lYXJlc3QobnVtYmVyVG9Sb3VuZCwgdmFsdWVUb05lYXJlc3QpIHtcclxuICAgIHJldHVybiBNYXRoLmNlaWwobnVtYmVyVG9Sb3VuZCAvIHZhbHVlVG9OZWFyZXN0KSAqIHZhbHVlVG9OZWFyZXN0O1xyXG4gIH1cclxuXHJcbiAgX2dldFBvc2l0aW9uV2l0aGluKGdhbWUpIHtcclxuICAgIHJldHVybiB0aGlzLl9yb3VuZFRvTmVhcmVzdCh0aGlzLl9yYW5kb21OdW1iZXJCZXR3ZWVuKDAsIGdhbWUud2lkdGggKiBnYW1lLmRpdmlzaW9uU2l6ZSAtIGdhbWUuZGl2aXNpb25TaXplKSwgZ2FtZS5kaXZpc2lvblNpemUpO1xyXG4gIH1cclxuXHJcbiAgX2luaXRpYWxpc2VHYW1lKCkge1xyXG4gICAgdGhpcy5nYW1lID0gbmV3IEdhbWUoMTI4LCAxMjgsIDUsIGZhbHNlLCB0aGlzLnN1Y2Nlc3NDcml0ZXJpYVZpc3VhbGl6YXRpb24pO1xyXG4gIH1cclxuXHJcbiAgX2dlbmVyYXRlSW5pdGlhbENvaG9ydCgpIHtcclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLnNpemVPZlBvcHVsYXRpb247IGluZGV4KyspIHtcclxuICAgICAgLy8gMCwwIHRvIDYzNSw2MzVcclxuICAgICAgY29uc3QgZ2Vub21lID0gbmV3IEdlbm9tZSh0aGlzLnNpemVPZkdlbm9tZSk7XHJcbiAgICAgIGNvbnN0IG5ldXJhbE5ldHdvcmsgPSBuZXcgTmV1cmFsTmV0d29yayh0aGlzLm51bWJlck9mTmV1cm9uc0luSGlkZGVuTGF5ZXIsIGdlbm9tZSwgdGhpcy5fc2Vuc2l0aXZpdHlOZXVyb25GYWN0b3J5KHRoaXMuZ2FtZSkpO1xyXG4gICAgICBjb25zdCBjcmVhdHVyZSA9IG5ldyBDcmVhdHVyZShcclxuICAgICAgICBnZW5vbWUsXHJcbiAgICAgICAgbmV1cmFsTmV0d29yayxcclxuICAgICAgICB0aGlzLl9nZXRQb3NpdGlvbldpdGhpbih0aGlzLmdhbWUpLFxyXG4gICAgICAgIHRoaXMuX2dldFBvc2l0aW9uV2l0aGluKHRoaXMuZ2FtZSksXHJcbiAgICAgICAgdGhpcy5nYW1lLmRpdmlzaW9uU2l6ZSxcclxuICAgICAgICB0aGlzLmdhbWUud2lkdGgsXHJcbiAgICAgICAgdGhpcy5nYW1lLmhlaWdodCxcclxuICAgICAgICAxLFxyXG4gICAgICAgIGZhbHNlXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuZ2FtZS5hZGRDcmVhdHVyZShjcmVhdHVyZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2VuZXJhdGVOZXh0Q29ob3J0KHN1cnZpdm9ycykge1xyXG4gICAgdGhpcy5nYW1lLmdhbWVDcmVhdHVyZXMgPSBbXTtcclxuICAgIGZvciAobGV0IGluZGV4T25lID0gMCwgaW5kZXhUd28gPSAyOyBpbmRleFR3byA8IHN1cnZpdm9ycy5sZW5ndGg7IGluZGV4T25lKyssIGluZGV4VHdvKyspIHtcclxuICAgICAgaWYgKHRoaXMuZ2FtZS5nYW1lQ3JlYXR1cmVzLmxlbmd0aCA+IHRoaXMuc2l6ZU9mUG9wdWxhdGlvbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiSGl0IHBvcHVsYXRpb24gbGltaXRcIik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgcGFyZW50T25lID0gc3Vydml2b3JzW2luZGV4T25lXTtcclxuICAgICAgY29uc3QgcGFyZW50VHdvID0gc3Vydml2b3JzW2luZGV4T25lICsgMV07XHJcbiAgICAgIGNvbnN0IHBhcmVudE9uZUdlbm9tZSA9IHBhcmVudE9uZS5nZW5vbWU7XHJcbiAgICAgIGNvbnN0IHBhcmVudFR3b0dlbm9tZSA9IHBhcmVudFR3by5nZW5vbWU7XHJcbiAgICAgIHZhciBjaGlsZEdlbm9tZU9uZSA9IEdlbm9tZS5jcmVhdGVOZXdHZW5vbWVGcm9tUGFyZW50cyhwYXJlbnRPbmVHZW5vbWUsIHBhcmVudFR3b0dlbm9tZSwgdGhpcy5tdXRhdGlvblJhdGUpO1xyXG4gICAgICB2YXIgY2hpbGRHZW5vbWVUd28gPSBHZW5vbWUuY3JlYXRlTmV3R2Vub21lRnJvbVBhcmVudHMocGFyZW50VHdvR2Vub21lLCBwYXJlbnRPbmVHZW5vbWUsIHRoaXMubXV0YXRpb25SYXRlKTtcclxuICAgICAgY29uc3QgbmV1cmFsTmV0d29ya09uZSA9IG5ldyBOZXVyYWxOZXR3b3JrKFxyXG4gICAgICAgIHRoaXMubnVtYmVyT2ZOZXVyb25zSW5IaWRkZW5MYXllcixcclxuICAgICAgICBjaGlsZEdlbm9tZU9uZSxcclxuICAgICAgICB0aGlzLl9zZW5zaXRpdml0eU5ldXJvbkZhY3RvcnkodGhpcy5nYW1lKVxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBuZXVyYWxOZXR3b3JrVHdvID0gbmV3IE5ldXJhbE5ldHdvcmsoXHJcbiAgICAgICAgdGhpcy5udW1iZXJPZk5ldXJvbnNJbkhpZGRlbkxheWVyLFxyXG4gICAgICAgIGNoaWxkR2Vub21lVHdvLFxyXG4gICAgICAgIHRoaXMuX3NlbnNpdGl2aXR5TmV1cm9uRmFjdG9yeSh0aGlzLmdhbWUpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBjb25zdCBjcmVhdHVyZU9uZSA9IG5ldyBDcmVhdHVyZShcclxuICAgICAgICBjaGlsZEdlbm9tZU9uZSxcclxuICAgICAgICBuZXVyYWxOZXR3b3JrT25lLFxyXG4gICAgICAgIHRoaXMuX2dldFBvc2l0aW9uV2l0aGluKHRoaXMuZ2FtZSksXHJcbiAgICAgICAgdGhpcy5fZ2V0UG9zaXRpb25XaXRoaW4odGhpcy5nYW1lKSxcclxuICAgICAgICB0aGlzLmdhbWUuZGl2aXNpb25TaXplLFxyXG4gICAgICAgIHRoaXMuZ2FtZS53aWR0aCxcclxuICAgICAgICB0aGlzLmdhbWUuaGVpZ2h0LFxyXG4gICAgICAgIDEsXHJcbiAgICAgICAgZmFsc2VcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IGNyZWF0dXJlVHdvID0gbmV3IENyZWF0dXJlKFxyXG4gICAgICAgIGNoaWxkR2Vub21lVHdvLFxyXG4gICAgICAgIG5ldXJhbE5ldHdvcmtUd28sXHJcbiAgICAgICAgdGhpcy5fZ2V0UG9zaXRpb25XaXRoaW4odGhpcy5nYW1lKSxcclxuICAgICAgICB0aGlzLl9nZXRQb3NpdGlvbldpdGhpbih0aGlzLmdhbWUpLFxyXG4gICAgICAgIHRoaXMuZ2FtZS5kaXZpc2lvblNpemUsXHJcbiAgICAgICAgdGhpcy5nYW1lLndpZHRoLFxyXG4gICAgICAgIHRoaXMuZ2FtZS5oZWlnaHQsXHJcbiAgICAgICAgMSxcclxuICAgICAgICBmYWxzZVxyXG4gICAgICApO1xyXG5cclxuICAgICAgdGhpcy5nYW1lLmFkZENyZWF0dXJlKGNyZWF0dXJlT25lKTtcclxuICAgICAgdGhpcy5nYW1lLmFkZENyZWF0dXJlKGNyZWF0dXJlVHdvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9hbmltYXRlKCkge1xyXG4gICAgdGhpcy5zdGVwQ291bnRMYWJlbC5pbm5lclRleHQgPSBgR2VuZXJhdGlvbiBTdGVwIENvdW50OiAke3RoaXMuY3VycmVudFN0ZXBDb3VudCsrfWA7XHJcbiAgICB0aGlzLmdhbWUudXBkYXRlKHRoaXMuY3VycmVudFN0ZXBDb3VudCk7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50U3RlcENvdW50IDw9IHRoaXMubW92ZXNQZXJHZW5lcmF0aW9uKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX2FuaW1hdGUuYmluZCh0aGlzKSksIDEwMDAgLyB0aGlzLmZyYW1lc1BlclNlY29uZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBUaGlzIGdlbmVyYXRpb24gaGFzIGZpbmlzaGVkLCB0aW1lIHRvIGdldCB0aGUgc3Vydml2b3JzIHRvIHJlcHJvZHVjZVxyXG4gICAgICAvLyBUaGVuIHNldCB0aGUgYm9hcmQgYmFjayB3aXRoIHRoZSBuZXcgZ2VuZXJhdGlvblxyXG4gICAgICB0aGlzLmdlbmVyYXRpb25Db3VudExhYmVsLmlubmVyVGV4dCA9IGBHZW4gJHsrK3RoaXMuY3VycmVudEdlbmVyYXRpb25Db3VudH1gO1xyXG4gICAgICBjb25zdCBzdXJ2aXZvcnMgPSB0aGlzLmdhbWUuZ2V0U3Vydml2b3JzKHRoaXMuc3VjY2Vzc0NyaXRlcmlhVmlzdWFsaXphdGlvbi5zdWNjZXNzQ3JpdGVyaWEpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgTnVtYmVyIG9mIHN1cnZpdm9ycyAke3N1cnZpdm9ycy5sZW5ndGh9LmApO1xyXG4gICAgICB0aGlzLl9nZW5lcmF0ZU5leHRDb2hvcnQoc3Vydml2b3JzKTtcclxuICAgICAgdGhpcy5jdXJyZW50U3RlcENvdW50ID0gMDtcclxuICAgICAgdGhpcy5fYW5pbWF0ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhcnQoKSB7XHJcbiAgICB0aGlzLmdlbmVyYXRpb25Db3VudExhYmVsLmlubmVyVGV4dCA9IGBHZW4gJHt0aGlzLmN1cnJlbnRHZW5lcmF0aW9uQ291bnR9YDtcclxuICAgIHRoaXMuX2luaXRpYWxpc2VHYW1lKCk7XHJcbiAgICB0aGlzLl9nZW5lcmF0ZUluaXRpYWxDb2hvcnQoKTtcclxuICAgIHRoaXMuX2FuaW1hdGUoKTtcclxuICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3\n')}]);